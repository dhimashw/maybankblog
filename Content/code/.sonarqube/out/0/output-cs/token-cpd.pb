é†
EC:\Review Code\Maybank Blog\Content\code\Controller\BlogController.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #

Controller# -
{ 
public 

class 
BlogController 
:  !

Controller" ,
{ 
public 
BlogController 
( 
IBlogRepository -
blogRepository. <
)< =
{ 	
this 
. 

Repository 
= 
blogRepository ,
;, -
} 	
IBlogRepository!! 

Repository!! "
{!!# $
get!!% (
;!!( )
}!!* +
private$$ 
static$$ 
Sitecore$$ 
.$$  
Mvc$$  #
.$$# $
Helpers$$$ +
.$$+ ,
SitecoreHelper$$, :
sitecoreHelper$$; I
;$$I J
private&& 
static&& 
Sitecore&& 
.&&  
Mvc&&  #
.&&# $
Helpers&&$ +
.&&+ ,
SitecoreHelper&&, :
SitecoreHelper&&; I
{'' 	
get(( 
{)) 
if** 
(** 
sitecoreHelper** "
==**# %
null**& *
)*** +
{++ 
sitecoreHelper,, "
=,,# $
Sitecore-- 
.-- 
Mvc-- "
.--" #
Helpers--# *
.--* +
ThreadHelper--+ 7
.--7 8
GetThreadData--8 E
<--E F
Sitecore--F N
.--N O
Mvc--O R
.--R S
Helpers--S Z
.--Z [
SitecoreHelper--[ i
>--i j
(--j k
)--k l
;--l m
}.. 
if00 
(00 
sitecoreHelper00 "
==00# %
null00& *
)00* +
{11 
ViewContext22 
viewContext22  +
=22, -
Sitecore22. 6
.226 7
Mvc227 :
.22: ;
Common22; A
.22A B
ContextService22B P
.22P Q
Get22Q T
(22T U
)22U V
.22V W

GetCurrent22W a
<22a b
ViewContext22b m
>22m n
(22n o
)22o p
;22p q
Sitecore33 
.33 
Diagnostics33 (
.33( )
Assert33) /
.33/ 0
	IsNotNull330 9
(339 :
viewContext33: E
,33E F
$str33G T
)33T U
;33U V

HtmlHelper44 

htmlHelper44 )
=44* +
new44, /

HtmlHelper440 :
(44: ;
viewContext55 !
,55! "
new66 
Sitecore66 "
.66" #
Mvc66# &
.66& '
Presentation66' 3
.663 4
ViewDataContainer664 E
(66E F
viewContext66F Q
.66Q R
ViewData66R Z
)66Z [
)66[ \
;66\ ]
Sitecore77 
.77 
Diagnostics77 (
.77( )
Assert77) /
.77/ 0
	IsNotNull770 9
(779 :

htmlHelper77: D
,77D E
$str77F R
)77R S
;77S T
sitecoreHelper88 "
=88# $
new88% (
Sitecore88) 1
.881 2
Mvc882 5
.885 6
Helpers886 =
.88= >
SitecoreHelper88> L
(88L M

htmlHelper88M W
)88W X
;88X Y
Sitecore99 
.99 
Diagnostics99 (
.99( )
Assert99) /
.99/ 0
	IsNotNull990 9
(999 :
sitecoreHelper99: H
,99H I
$str99J Z
)99Z [
;99[ \
Sitecore:: 
.:: 
Mvc::  
.::  !
Helpers::! (
.::( )
ThreadHelper::) 5
.::5 6
SetThreadData::6 C
<::C D
Sitecore::D L
.::L M
Mvc::M P
.::P Q
Helpers::Q X
.::X Y
SitecoreHelper::Y g
>::g h
(::h i
sitecoreHelper;; $
);;$ %
;;;% &
}<< 
return>> 
sitecoreHelper>> %
;>>% &
}?? 
}@@ 	
publicAA 
ActionResultAA 
	BlogStashAA %
(AA% &
)AA& '
{BB 	
varDD 
PageSizeDD 
=DD 
RenderingContextDD +
.DD+ ,
CurrentDD, 3
.DD3 4
	RenderingDD4 =
.DD= >
GetIntegerParameterDD> Q
(DDQ R
$strDDR \
,DD\ ]
$numDD^ _
)DD_ `
;DD` a
SitecoreHH 
.HH 
DataHH 
.HH 
ItemsHH 
.HH  
ItemHH  $
dataSourceItemHH% 3
=HH4 5
RenderingContextHH6 F
.HHF G
CurrentHHG N
.HHN O
	RenderingHHO X
.HHX Y
ItemHHY ]
;HH] ^
	PagedDataJJ 
<JJ 
DataJJ 
.JJ 
ItemsJJ  
.JJ  !
ItemJJ! %
>JJ% &
	listItemsJJ' 0
=JJ1 2
newJJ3 6
	PagedDataJJ7 @
<JJ@ A
DataJJA E
.JJE F
ItemsJJF K
.JJK L
ItemJJL P
>JJP Q
(JJQ R
)JJR S
;JJS T
tryLL 
{MM 
IEnumerableOO 
<OO 
DataOO  
.OO  !
ItemsOO! &
.OO& '
ItemOO' +
>OO+ ,
itemsOO- 2
=OO3 4
thisOO5 9
.OO9 :

RepositoryOO: D
.OOD E
GetOOE H
(OOH I
dataSourceItemOOI W
)OOW X
;OOX Y
ifPP 
(PP 
itemsPP 
!=PP 
nullPP !
&&PP" $
itemsPP% *
.PP* +
CountPP+ 0
(PP0 1
)PP1 2
>PP3 4
$numPP5 6
)PP6 7
{QQ 
	listItemsRR 
.RR 
DataRR "
=RR# $
itemsRR% *
.RR* +
TakeRR+ /
(RR/ 0
PageSizeRR0 8
)RR8 9
;RR9 :
	listItemsSS 
.SS 
NumberOfPagesSS +
=SS, -
ConvertSS. 5
.SS5 6
ToInt32SS6 =
(SS= >
MathSS> B
.SSB C
CeilingSSC J
(SSJ K
(SSK L
doubleSSL R
)SSR S
itemsSSS X
.SSX Y
CountSSY ^
(SS^ _
)SS_ `
/SSa b
PageSizeSSc k
)SSk l
)SSl m
;SSm n
	listItemsTT 
.TT 
CurrentPageTT )
=TT* +
$numTT, -
;TT- .
	listItemsUU 
.UU 
PageSizeUU &
=UU' (
PageSizeUU) 1
;UU1 2
}VV 
	listItemsWW 
.WW 
DataSourceIDWW &
=WW' (
RenderingContextWW) 9
.WW9 :
CurrentWW: A
.WWA B
	RenderingWWB K
.WWK L
ItemWWL P
.WWP Q
IDWWQ S
;WWS T
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 
return\\ 
ErrorWebservice\\ &
(\\& '
new\\' * 
JavaScriptSerializer\\+ ?
(\\? @
)\\@ A
.\\A B
	Serialize\\B K
(\\K L
new\\L O
ReturnErrorData\\P _
{]] 
responseCode^^  
=^^! "
$str^^# (
,^^( )
descErrorCode__ !
=__" #
ex__$ &
.__& '
Message__' .
.__. /
ToString__/ 7
(__7 8
)__8 9
}`` 
)`` 
)`` 
;`` 
}aa 
returncc 
Viewcc 
(cc 
$strcc 6
,cc6 7
	listItemscc8 A
)ccA B
;ccB C
}dd 	
publicff 
ActionResultff 
BlogStashListPagingff /
(ff/ 0
intff0 3
pageff4 8
,ff8 9
intff: =
PageSizeff> F
,ffF G
stringffH N
idffO Q
)ffQ R
{gg 	
varhh 
	listItemshh 
=hh 
newhh 
	PagedDatahh  )
<hh) *
Datahh* .
.hh. /
Itemshh/ 4
.hh4 5
Itemhh5 9
>hh9 :
(hh: ;
)hh; <
;hh< =
tryjj 
{kk 
IEnumerablell 
<ll 
Datall  
.ll  !
Itemsll! &
.ll& '
Itemll' +
>ll+ ,
itemsll- 2
=ll3 4
thisll5 9
.ll9 :

Repositoryll: D
.llD E
GetllE H
(llH I
SitecorellI Q
.llQ R
ContextllR Y
.llY Z
DatabasellZ b
.llb c
GetItemllc j
(llj k
newllk n
Datallo s
.lls t
IDllt v
(llv w
idllw y
)lly z
)llz {
)ll{ |
;ll| }
	listItemsnn 
.nn 
Datann 
=nn  
itemsnn! &
.nn& '
Skipnn' +
(nn+ ,
PageSizenn, 4
*nn5 6
(nn7 8
pagenn8 <
-nn= >
$numnn? @
)nn@ A
)nnA B
.nnB C
TakennC G
(nnG H
PageSizennH P
)nnP Q
;nnQ R
	listItemsoo 
.oo 
NumberOfPagesoo '
=oo( )
Convertoo* 1
.oo1 2
ToInt32oo2 9
(oo9 :
Mathoo: >
.oo> ?
Ceilingoo? F
(ooF G
(ooG H
doubleooH N
)ooN O
itemsooO T
.ooT U
CountooU Z
(ooZ [
)oo[ \
/oo] ^
PageSizeoo_ g
)oog h
)ooh i
;ooi j
	listItemspp 
.pp 
CurrentPagepp %
=pp& '
pagepp( ,
;pp, -
	listItemsqq 
.qq 
DataSourceIDqq &
=qq' (
newqq) ,
Dataqq- 1
.qq1 2
IDqq2 4
(qq4 5
idqq5 7
)qq7 8
;qq8 9
	listItemsrr 
.rr 
PageSizerr "
=rr# $
PageSizerr% -
;rr- .
}ss 
catchtt 
(tt 
	Exceptiontt 
extt 
)tt  
{uu 
returnvv 
ErrorWebservicevv &
(vv& '
newvv' * 
JavaScriptSerializervv+ ?
(vv? @
)vv@ A
.vvA B
	SerializevvB K
(vvK L
newvvL O
ReturnErrorDatavvP _
{ww 
responseCodexx  
=xx! "
$strxx# (
,xx( )
descErrorCodeyy !
=yy" #
exyy$ &
.yy& '
Messageyy' .
.yy. /
ToStringyy/ 7
(yy7 8
)yy8 9
}zz 
)zz 
)zz 
;zz 
}{{ 
return}} 
PartialView}} 
(}} 
$str}} =
,}}= >
	listItems}}? H
)}}H I
;}}I J
}~~ 	
public
ÄÄ 
ActionResult
ÄÄ 
ArticleStash
ÄÄ (
(
ÄÄ( )
)
ÄÄ) *
{
ÅÅ 	
var
ÉÉ 
PageSize
ÉÉ 
=
ÉÉ 
RenderingContext
ÉÉ +
.
ÉÉ+ ,
Current
ÉÉ, 3
.
ÉÉ3 4
	Rendering
ÉÉ4 =
.
ÉÉ= >!
GetIntegerParameter
ÉÉ> Q
(
ÉÉQ R
$str
ÉÉR \
,
ÉÉ\ ]
$num
ÉÉ^ _
)
ÉÉ_ `
;
ÉÉ` a
Sitecore
áá 
.
áá 
Data
áá 
.
áá 
Items
áá 
.
áá  
Item
áá  $
dataSourceItem
áá% 3
=
áá4 5
RenderingContext
áá6 F
.
ááF G
Current
ááG N
.
ááN O
	Rendering
ááO X
.
ááX Y
Item
ááY ]
;
áá] ^
	PagedData
ââ 
<
ââ 
Data
ââ 
.
ââ 
Items
ââ  
.
ââ  !
Item
ââ! %
>
ââ% &
	listItems
ââ' 0
=
ââ1 2
new
ââ3 6
	PagedData
ââ7 @
<
ââ@ A
Data
ââA E
.
ââE F
Items
ââF K
.
ââK L
Item
ââL P
>
ââP Q
(
ââQ R
)
ââR S
;
ââS T
try
ãã 
{
åå 
IEnumerable
éé 
<
éé 
Data
éé  
.
éé  !
Items
éé! &
.
éé& '
Item
éé' +
>
éé+ ,
items
éé- 2
=
éé3 4
this
éé5 9
.
éé9 :

Repository
éé: D
.
ééD E

GetArticle
ééE O
(
ééO P
dataSourceItem
ééP ^
)
éé^ _
;
éé_ `
if
èè 
(
èè 
items
èè 
!=
èè 
null
èè !
&&
èè" $
items
èè% *
.
èè* +
Count
èè+ 0
(
èè0 1
)
èè1 2
>
èè3 4
$num
èè5 6
)
èè6 7
{
êê 
	listItems
ëë 
.
ëë 
Data
ëë "
=
ëë# $
items
ëë% *
.
ëë* +
Take
ëë+ /
(
ëë/ 0
PageSize
ëë0 8
)
ëë8 9
;
ëë9 :
	listItems
íí 
.
íí 
NumberOfPages
íí +
=
íí, -
Convert
íí. 5
.
íí5 6
ToInt32
íí6 =
(
íí= >
Math
íí> B
.
ííB C
Ceiling
ííC J
(
ííJ K
(
ííK L
double
ííL R
)
ííR S
items
ííS X
.
ííX Y
Count
ííY ^
(
íí^ _
)
íí_ `
/
íía b
PageSize
ííc k
)
íík l
)
ííl m
;
íím n
	listItems
ìì 
.
ìì 
CurrentPage
ìì )
=
ìì* +
$num
ìì, -
;
ìì- .
	listItems
îî 
.
îî 
PageSize
îî &
=
îî' (
PageSize
îî) 1
;
îî1 2
}
ïï 
	listItems
ññ 
.
ññ 
DataSourceID
ññ &
=
ññ' (
RenderingContext
ññ) 9
.
ññ9 :
Current
ññ: A
.
ññA B
	Rendering
ññB K
.
ññK L
Item
ññL P
.
ññP Q
ID
ññQ S
;
ññS T
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
öö 
return
õõ 
ErrorWebservice
õõ &
(
õõ& '
new
õõ' *"
JavaScriptSerializer
õõ+ ?
(
õõ? @
)
õõ@ A
.
õõA B
	Serialize
õõB K
(
õõK L
new
õõL O
ReturnErrorData
õõP _
{
úú 
responseCode
ùù  
=
ùù! "
$str
ùù# (
,
ùù( )
descErrorCode
ûû !
=
ûû" #
ex
ûû$ &
.
ûû& '
Message
ûû' .
.
ûû. /
ToString
ûû/ 7
(
ûû7 8
)
ûû8 9
}
üü 
)
üü 
)
üü 
;
üü 
}
†† 
return
¢¢ 
View
¢¢ 
(
¢¢ 
$str
¢¢ <
,
¢¢< =
	listItems
¢¢> G
)
¢¢G H
;
¢¢H I
}
££ 	
public
•• 
ActionResult
•• $
ArticleStashListPaging
•• 2
(
••2 3
int
••3 6
page
••7 ;
,
••; <
int
••= @
PageSize
••A I
,
••I J
string
••K Q
id
••R T
)
••T U
{
¶¶ 	
var
ßß 
	listItems
ßß 
=
ßß 
new
ßß 
	PagedData
ßß  )
<
ßß) *
Data
ßß* .
.
ßß. /
Items
ßß/ 4
.
ßß4 5
Item
ßß5 9
>
ßß9 :
(
ßß: ;
)
ßß; <
;
ßß< =
try
©© 
{
™™ 
IEnumerable
´´ 
<
´´ 
Data
´´  
.
´´  !
Items
´´! &
.
´´& '
Item
´´' +
>
´´+ ,
items
´´- 2
=
´´3 4
this
´´5 9
.
´´9 :

Repository
´´: D
.
´´D E

GetArticle
´´E O
(
´´O P
Sitecore
´´P X
.
´´X Y
Context
´´Y `
.
´´` a
Database
´´a i
.
´´i j
GetItem
´´j q
(
´´q r
new
´´r u
Data
´´v z
.
´´z {
ID
´´{ }
(
´´} ~
id´´~ Ä
)´´Ä Å
)´´Å Ç
)´´Ç É
;´´É Ñ
	listItems
≠≠ 
.
≠≠ 
Data
≠≠ 
=
≠≠  
items
≠≠! &
.
≠≠& '
Skip
≠≠' +
(
≠≠+ ,
PageSize
≠≠, 4
*
≠≠5 6
(
≠≠7 8
page
≠≠8 <
-
≠≠= >
$num
≠≠? @
)
≠≠@ A
)
≠≠A B
.
≠≠B C
Take
≠≠C G
(
≠≠G H
PageSize
≠≠H P
)
≠≠P Q
;
≠≠Q R
	listItems
ÆÆ 
.
ÆÆ 
NumberOfPages
ÆÆ '
=
ÆÆ( )
Convert
ÆÆ* 1
.
ÆÆ1 2
ToInt32
ÆÆ2 9
(
ÆÆ9 :
Math
ÆÆ: >
.
ÆÆ> ?
Ceiling
ÆÆ? F
(
ÆÆF G
(
ÆÆG H
double
ÆÆH N
)
ÆÆN O
items
ÆÆO T
.
ÆÆT U
Count
ÆÆU Z
(
ÆÆZ [
)
ÆÆ[ \
/
ÆÆ] ^
PageSize
ÆÆ_ g
)
ÆÆg h
)
ÆÆh i
;
ÆÆi j
	listItems
ØØ 
.
ØØ 
CurrentPage
ØØ %
=
ØØ& '
page
ØØ( ,
;
ØØ, -
	listItems
∞∞ 
.
∞∞ 
DataSourceID
∞∞ &
=
∞∞' (
new
∞∞) ,
Data
∞∞- 1
.
∞∞1 2
ID
∞∞2 4
(
∞∞4 5
id
∞∞5 7
)
∞∞7 8
;
∞∞8 9
	listItems
±± 
.
±± 
PageSize
±± "
=
±±# $
PageSize
±±% -
;
±±- .
}
≤≤ 
catch
≥≥ 
(
≥≥ 
	Exception
≥≥ 
ex
≥≥ 
)
≥≥  
{
¥¥ 
return
µµ 
ErrorWebservice
µµ &
(
µµ& '
new
µµ' *"
JavaScriptSerializer
µµ+ ?
(
µµ? @
)
µµ@ A
.
µµA B
	Serialize
µµB K
(
µµK L
new
µµL O
ReturnErrorData
µµP _
{
∂∂ 
responseCode
∑∑  
=
∑∑! "
$str
∑∑# (
,
∑∑( )
descErrorCode
∏∏ !
=
∏∏" #
ex
∏∏$ &
.
∏∏& '
Message
∏∏' .
.
∏∏. /
ToString
∏∏/ 7
(
∏∏7 8
)
∏∏8 9
}
ππ 
)
ππ 
)
ππ 
;
ππ 
}
∫∫ 
return
ºº 
PartialView
ºº 
(
ºº 
$str
ºº C
,
ººC D
	listItems
ººE N
)
ººN O
;
ººO P
}
ΩΩ 	
public
øø 
ActionResult
øø 

LatestNews
øø &
(
øø& '
)
øø' (
{
¿¿ 	
	PagedData
¡¡ 
<
¡¡ 
Data
¡¡ 
.
¡¡ 
Items
¡¡  
.
¡¡  !
Item
¡¡! %
>
¡¡% &
	listItems
¡¡' 0
=
¡¡1 2
new
¡¡3 6
	PagedData
¡¡7 @
<
¡¡@ A
Data
¡¡A E
.
¡¡E F
Items
¡¡F K
.
¡¡K L
Item
¡¡L P
>
¡¡P Q
(
¡¡Q R
)
¡¡R S
;
¡¡S T
try
¬¬ 
{
√√ 
Sitecore
ƒƒ 
.
ƒƒ 
Data
ƒƒ 
.
ƒƒ 
Items
ƒƒ #
.
ƒƒ# $
Item
ƒƒ$ (
datasourceItem
ƒƒ) 7
=
ƒƒ8 9
RenderingContext
ƒƒ: J
.
ƒƒJ K
Current
ƒƒK R
.
ƒƒR S
	Rendering
ƒƒS \
.
ƒƒ\ ]
Item
ƒƒ] a
;
ƒƒa b
Sitecore
≈≈ 
.
≈≈ 
Data
≈≈ 
.
≈≈ 
Fields
≈≈ $
.
≈≈$ %
DatasourceField
≈≈% 4
dsf
≈≈5 8
=
≈≈9 :
datasourceItem
≈≈; I
.
≈≈I J
Fields
≈≈J P
[
≈≈P Q
Sitecore
≈≈Q Y
.
≈≈Y Z
Feature
≈≈Z a
.
≈≈a b
Library
≈≈b i
.
≈≈i j
	Templates
≈≈j s
.
≈≈s t
LatestArticleMBM≈≈t Ñ
.≈≈Ñ Ö
Fields≈≈Ö ã
.≈≈ã å

DataSource≈≈å ñ
]≈≈ñ ó
;≈≈ó ò
IEnumerable
«« 
<
«« 
Data
««  
.
««  !
Items
««! &
.
««& '
Item
««' +
>
««+ ,
items
««- 2
=
««3 4
this
««5 9
.
««9 :

Repository
««: D
.
««D E

GetArticle
««E O
(
««O P
dsf
««P S
.
««S T

TargetItem
««T ^
)
««^ _
;
««_ `
if
…… 
(
…… 
items
…… 
!=
…… 
null
…… !
&&
……" $
items
……% *
.
……* +
Count
……+ 0
(
……0 1
)
……1 2
>
……3 4
$num
……5 6
)
……6 7
{
   
	listItems
ÀÀ 
.
ÀÀ 
Data
ÀÀ "
=
ÀÀ# $
items
ÀÀ% *
.
ÀÀ* +
Take
ÀÀ+ /
(
ÀÀ/ 0
$num
ÀÀ0 1
)
ÀÀ1 2
;
ÀÀ2 3
}
ÃÃ 
	listItems
ÕÕ 
.
ÕÕ 
DataSourceID
ÕÕ &
=
ÕÕ' (
RenderingContext
ÕÕ) 9
.
ÕÕ9 :
Current
ÕÕ: A
.
ÕÕA B
	Rendering
ÕÕB K
.
ÕÕK L
Item
ÕÕL P
.
ÕÕP Q
ID
ÕÕQ S
;
ÕÕS T
}
ŒŒ 
catch
œœ 
(
œœ 
	Exception
œœ 
)
œœ 
{
œœ 
}
œœ  !
return
—— 
View
—— 
(
—— 
$str
—— =
,
——= >
	listItems
——? H
)
——H I
;
——I J
}
““ 	
public
‘‘ 
ActionResult
‘‘ 

ImageStash
‘‘ &
(
‘‘& '
)
‘‘' (
{
’’ 	
int
◊◊ 
PageSize
◊◊ 
=
◊◊ 
RenderingContext
◊◊ +
.
◊◊+ ,
Current
◊◊, 3
.
◊◊3 4
	Rendering
◊◊4 =
.
◊◊= >!
GetIntegerParameter
◊◊> Q
(
◊◊Q R
$str
◊◊R \
,
◊◊\ ]
$num
◊◊^ `
)
◊◊` a
;
◊◊a b
string
ÿÿ 
_Year
ÿÿ 
=
ÿÿ 
RenderingContext
ÿÿ +
.
ÿÿ+ ,
Current
ÿÿ, 3
.
ÿÿ3 4
	Rendering
ÿÿ4 =
.
ÿÿ= >!
GetIntegerParameter
ÿÿ> Q
(
ÿÿQ R
$str
ÿÿR X
,
ÿÿX Y
DateTime
ÿÿZ b
.
ÿÿb c
Now
ÿÿc f
.
ÿÿf g
Year
ÿÿg k
)
ÿÿk l
.
ÿÿl m
ToString
ÿÿm u
(
ÿÿu v
)
ÿÿv w
;
ÿÿw x
Sitecore
‹‹ 
.
‹‹ 
Data
‹‹ 
.
‹‹ 
Items
‹‹ 
.
‹‹  
Item
‹‹  $
dataSourceItem
‹‹% 3
=
‹‹4 5
RenderingContext
‹‹6 F
.
‹‹F G
Current
‹‹G N
.
‹‹N O
	Rendering
‹‹O X
.
‹‹X Y
Item
‹‹Y ]
;
‹‹] ^
	PagedData
ﬁﬁ 
<
ﬁﬁ 
Data
ﬁﬁ 
.
ﬁﬁ 
Items
ﬁﬁ  
.
ﬁﬁ  !
Item
ﬁﬁ! %
>
ﬁﬁ% &
	listItems
ﬁﬁ' 0
=
ﬁﬁ1 2
new
ﬁﬁ3 6
	PagedData
ﬁﬁ7 @
<
ﬁﬁ@ A
Data
ﬁﬁA E
.
ﬁﬁE F
Items
ﬁﬁF K
.
ﬁﬁK L
Item
ﬁﬁL P
>
ﬁﬁP Q
(
ﬁﬁQ R
)
ﬁﬁR S
;
ﬁﬁS T
try
‡‡ 
{
·· 
IEnumerable
„„ 
<
„„ 
Data
„„  
.
„„  !
Items
„„! &
.
„„& '
Item
„„' +
>
„„+ ,
items
„„- 2
=
„„3 4
this
„„5 9
.
„„9 :

Repository
„„: D
.
„„D E

GetGallery
„„E O
(
„„O P
dataSourceItem
„„P ^
)
„„^ _
.
„„_ `
Where
„„` e
(
„„e f
x
„„f g
=>
„„h j
x
„„k l
.
„„l m
Fields
„„m s
[
„„s t
Sitecore
„„t |
.
„„| }
Feature„„} Ñ
.„„Ñ Ö
Library„„Ö å
.„„å ç
	Templates„„ç ñ
.„„ñ ó
	BaseField„„ó †
.„„† °
Fields„„° ß
.„„ß ®
_year„„® ≠
]„„≠ Æ
!=„„Ø ±
null„„≤ ∂
&&„„∑ π
x„„∫ ª
.„„ª º
Fields„„º ¬
[„„¬ √
Sitecore„„√ À
.„„À Ã
Feature„„Ã ”
.„„” ‘
Library„„‘ €
.„„€ ‹
	Templates„„‹ Â
.„„Â Ê
	BaseField„„Ê Ô
.„„Ô 
Fields„„ ˆ
.„„ˆ ˜
_year„„˜ ¸
]„„¸ ˝
.„„˝ ˛
Value„„˛ É
==„„Ñ Ü
_Year„„á å
)„„å ç
;„„ç é
if
‰‰ 
(
‰‰ 
items
‰‰ 
!=
‰‰ 
null
‰‰ !
&&
‰‰" $
items
‰‰% *
.
‰‰* +
Count
‰‰+ 0
(
‰‰0 1
)
‰‰1 2
>
‰‰3 4
$num
‰‰5 6
)
‰‰6 7
{
ÂÂ 
	listItems
ÊÊ 
.
ÊÊ 
Data
ÊÊ "
=
ÊÊ# $
items
ÊÊ% *
.
ÊÊ* +
Take
ÊÊ+ /
(
ÊÊ/ 0
PageSize
ÊÊ0 8
)
ÊÊ8 9
;
ÊÊ9 :
	listItems
ÁÁ 
.
ÁÁ 
NumberOfPages
ÁÁ +
=
ÁÁ, -
Convert
ÁÁ. 5
.
ÁÁ5 6
ToInt32
ÁÁ6 =
(
ÁÁ= >
Math
ÁÁ> B
.
ÁÁB C
Ceiling
ÁÁC J
(
ÁÁJ K
(
ÁÁK L
double
ÁÁL R
)
ÁÁR S
items
ÁÁS X
.
ÁÁX Y
Count
ÁÁY ^
(
ÁÁ^ _
)
ÁÁ_ `
/
ÁÁa b
PageSize
ÁÁc k
)
ÁÁk l
)
ÁÁl m
;
ÁÁm n
	listItems
ËË 
.
ËË 
CurrentPage
ËË )
=
ËË* +
$num
ËË, -
;
ËË- .
	listItems
ÈÈ 
.
ÈÈ 
PageSize
ÈÈ &
=
ÈÈ' (
PageSize
ÈÈ) 1
;
ÈÈ1 2
}
ÍÍ 
	listItems
ÎÎ 
.
ÎÎ 
DataSourceID
ÎÎ &
=
ÎÎ' (
RenderingContext
ÎÎ) 9
.
ÎÎ9 :
Current
ÎÎ: A
.
ÎÎA B
	Rendering
ÎÎB K
.
ÎÎK L
Item
ÎÎL P
.
ÎÎP Q
ID
ÎÎQ S
;
ÎÎS T
}
ÌÌ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
return
 
ErrorWebservice
 &
(
& '
new
' *"
JavaScriptSerializer
+ ?
(
? @
)
@ A
.
A B
	Serialize
B K
(
K L
new
L O
ReturnErrorData
P _
{
ÒÒ 
responseCode
ÚÚ  
=
ÚÚ! "
$str
ÚÚ# (
,
ÚÚ( )
descErrorCode
ÛÛ !
=
ÛÛ" #
ex
ÛÛ$ &
.
ÛÛ& '
Message
ÛÛ' .
.
ÛÛ. /
ToString
ÛÛ/ 7
(
ÛÛ7 8
)
ÛÛ8 9
}
ÙÙ 
)
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ıı 
return
˜˜ 
View
˜˜ 
(
˜˜ 
$str
˜˜ :
,
˜˜: ;
	listItems
˜˜< E
)
˜˜E F
;
˜˜F G
}
¯¯ 	
public
˙˙ 
ActionResult
˙˙ "
ImageStashListPaging
˙˙ 0
(
˙˙0 1
int
˙˙1 4
page
˙˙5 9
,
˙˙9 :
int
˙˙; >
PageSize
˙˙? G
,
˙˙G H
string
˙˙I O
id
˙˙P R
,
˙˙R S
string
˙˙T Z
_Year
˙˙[ `
)
˙˙` a
{
˚˚ 	
var
¸¸ 
	listItems
¸¸ 
=
¸¸ 
new
¸¸ 
	PagedData
¸¸  )
<
¸¸) *
Data
¸¸* .
.
¸¸. /
Items
¸¸/ 4
.
¸¸4 5
Item
¸¸5 9
>
¸¸9 :
(
¸¸: ;
)
¸¸; <
;
¸¸< =
try
˛˛ 
{
ˇˇ 
IEnumerable
ÄÄ 
<
ÄÄ 
Data
ÄÄ  
.
ÄÄ  !
Items
ÄÄ! &
.
ÄÄ& '
Item
ÄÄ' +
>
ÄÄ+ ,
items
ÄÄ- 2
=
ÄÄ3 4
this
ÄÄ5 9
.
ÄÄ9 :

Repository
ÄÄ: D
.
ÄÄD E

GetGallery
ÄÄE O
(
ÄÄO P
Sitecore
ÄÄP X
.
ÄÄX Y
Context
ÄÄY `
.
ÄÄ` a
Database
ÄÄa i
.
ÄÄi j
GetItem
ÄÄj q
(
ÄÄq r
new
ÄÄr u
Data
ÄÄv z
.
ÄÄz {
ID
ÄÄ{ }
(
ÄÄ} ~
idÄÄ~ Ä
)ÄÄÄ Å
)ÄÄÅ Ç
)ÄÄÇ É
.ÄÄÉ Ñ
WhereÄÄÑ â
(ÄÄâ ä
xÄÄä ã
=>ÄÄå é
xÄÄè ê
.ÄÄê ë
FieldsÄÄë ó
[ÄÄó ò
SitecoreÄÄò †
.ÄÄ† °
FeatureÄÄ° ®
.ÄÄ® ©
LibraryÄÄ© ∞
.ÄÄ∞ ±
	TemplatesÄÄ± ∫
.ÄÄ∫ ª
	BaseFieldÄÄª ƒ
.ÄÄƒ ≈
FieldsÄÄ≈ À
.ÄÄÀ Ã
_yearÄÄÃ —
]ÄÄ— “
!=ÄÄ” ’
nullÄÄ÷ ⁄
&&ÄÄ€ ›
xÄÄﬁ ﬂ
.ÄÄﬂ ‡
FieldsÄÄ‡ Ê
[ÄÄÊ Á
SitecoreÄÄÁ Ô
.ÄÄÔ 
FeatureÄÄ ˜
.ÄÄ˜ ¯
LibraryÄÄ¯ ˇ
.ÄÄˇ Ä
	TemplatesÄÄÄ â
.ÄÄâ ä
	BaseFieldÄÄä ì
.ÄÄì î
FieldsÄÄî ö
.ÄÄö õ
_yearÄÄõ †
]ÄÄ† °
.ÄÄ° ¢
ValueÄÄ¢ ß
==ÄÄ® ™
_YearÄÄ´ ∞
)ÄÄ∞ ±
;ÄÄ± ≤
	listItems
ÇÇ 
.
ÇÇ 
Data
ÇÇ 
=
ÇÇ  
items
ÇÇ! &
.
ÇÇ& '
Skip
ÇÇ' +
(
ÇÇ+ ,
PageSize
ÇÇ, 4
*
ÇÇ5 6
(
ÇÇ7 8
page
ÇÇ8 <
-
ÇÇ= >
$num
ÇÇ? @
)
ÇÇ@ A
)
ÇÇA B
.
ÇÇB C
Take
ÇÇC G
(
ÇÇG H
PageSize
ÇÇH P
)
ÇÇP Q
;
ÇÇQ R
	listItems
ÉÉ 
.
ÉÉ 
NumberOfPages
ÉÉ '
=
ÉÉ( )
Convert
ÉÉ* 1
.
ÉÉ1 2
ToInt32
ÉÉ2 9
(
ÉÉ9 :
Math
ÉÉ: >
.
ÉÉ> ?
Ceiling
ÉÉ? F
(
ÉÉF G
(
ÉÉG H
double
ÉÉH N
)
ÉÉN O
items
ÉÉO T
.
ÉÉT U
Count
ÉÉU Z
(
ÉÉZ [
)
ÉÉ[ \
/
ÉÉ] ^
PageSize
ÉÉ_ g
)
ÉÉg h
)
ÉÉh i
;
ÉÉi j
	listItems
ÑÑ 
.
ÑÑ 
CurrentPage
ÑÑ %
=
ÑÑ& '
page
ÑÑ( ,
;
ÑÑ, -
	listItems
ÖÖ 
.
ÖÖ 
DataSourceID
ÖÖ &
=
ÖÖ' (
new
ÖÖ) ,
Data
ÖÖ- 1
.
ÖÖ1 2
ID
ÖÖ2 4
(
ÖÖ4 5
id
ÖÖ5 7
)
ÖÖ7 8
;
ÖÖ8 9
	listItems
ÜÜ 
.
ÜÜ 
PageSize
ÜÜ "
=
ÜÜ# $
PageSize
ÜÜ% -
;
ÜÜ- .
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
return
ää 
ErrorWebservice
ää &
(
ää& '
new
ää' *"
JavaScriptSerializer
ää+ ?
(
ää? @
)
ää@ A
.
ääA B
	Serialize
ääB K
(
ääK L
new
ääL O
ReturnErrorData
ääP _
{
ãã 
responseCode
åå  
=
åå! "
$str
åå# (
,
åå( )
descErrorCode
çç !
=
çç" #
ex
çç$ &
.
çç& '
Message
çç' .
.
çç. /
ToString
çç/ 7
(
çç7 8
)
çç8 9
}
éé 
)
éé 
)
éé 
;
éé 
}
èè 
return
ëë 
PartialView
ëë 
(
ëë 
$str
ëë A
,
ëëA B
	listItems
ëëC L
)
ëëL M
;
ëëM N
}
íí 	
public
îî 
ActionResult
îî '
LatestImageGalleryPerYear
îî 5
(
îî5 6
)
îî6 7
{
ïï 	
Sitecore
ññ 
.
ññ 
Data
ññ 
.
ññ 
Items
ññ 
.
ññ  
Item
ññ  $
datasourceItem
ññ% 3
=
ññ4 5
RenderingContext
ññ6 F
.
ññF G
Current
ññG N
.
ññN O
	Rendering
ññO X
.
ññX Y
Item
ññY ]
;
ññ] ^
Sitecore
óó 
.
óó 
Data
óó 
.
óó 
Fields
óó  
.
óó  !
DatasourceField
óó! 0
dsf
óó1 4
=
óó5 6
datasourceItem
óó7 E
.
óóE F
Fields
óóF L
[
óóL M
Sitecore
óóM U
.
óóU V
Feature
óóV ]
.
óó] ^
Library
óó^ e
.
óóe f
	Templates
óóf o
.
óóo p&
LatestGalleryPerYearMBMóóp á
.óóá à
Fieldsóóà é
.óóé è

DataSourceóóè ô
]óóô ö
;óóö õ
string
ôô 
_Year
ôô 
=
ôô 
datasourceItem
ôô )
.
ôô) *
Fields
ôô* 0
[
ôô0 1
Sitecore
ôô1 9
.
ôô9 :
Feature
ôô: A
.
ôôA B
Library
ôôB I
.
ôôI J
	Templates
ôôJ S
.
ôôS T
	BaseField
ôôT ]
.
ôô] ^
Fields
ôô^ d
.
ôôd e
_year
ôôe j
]
ôôj k
!=
ôôl n
null
ôôo s
?
ôôt u
datasourceItemôôv Ñ
.ôôÑ Ö
FieldsôôÖ ã
[ôôã å
Sitecoreôôå î
.ôôî ï
Featureôôï ú
.ôôú ù
Libraryôôù §
.ôô§ •
	Templatesôô• Æ
.ôôÆ Ø
	BaseFieldôôØ ∏
.ôô∏ π
Fieldsôôπ ø
.ôôø ¿
_yearôô¿ ≈
]ôô≈ ∆
.ôô∆ «
ToStringôô« œ
(ôôœ –
)ôô– —
:ôô“ ”
$strôô‘ ⁄
;ôô⁄ €
	PagedData
öö 
<
öö 
Data
öö 
.
öö 
Items
öö  
.
öö  !
Item
öö! %
>
öö% &
	listItems
öö' 0
=
öö1 2
new
öö3 6
	PagedData
öö7 @
<
öö@ A
Data
ööA E
.
ööE F
Items
ööF K
.
ööK L
Item
ööL P
>
ööP Q
(
ööQ R
)
ööR S
;
ööS T
try
õõ 
{
úú 
IEnumerable
ùù 
<
ùù 
Data
ùù  
.
ùù  !
Items
ùù! &
.
ùù& '
Item
ùù' +
>
ùù+ ,
items
ùù- 2
=
ùù3 4
this
ùù5 9
.
ùù9 :

Repository
ùù: D
.
ùùD E

GetGallery
ùùE O
(
ùùO P
dsf
ùùP S
.
ùùS T

TargetItem
ùùT ^
)
ùù^ _
.
ùù_ `
Where
ùù` e
(
ùùe f
x
ùùf g
=>
ùùh j
x
ùùk l
.
ùùl m
Fields
ùùm s
[
ùùs t
Sitecore
ùùt |
.
ùù| }
Featureùù} Ñ
.ùùÑ Ö
LibraryùùÖ å
.ùùå ç
	Templatesùùç ñ
.ùùñ ó
	BaseFieldùùó †
.ùù† °
Fieldsùù° ß
.ùùß ®
_yearùù® ≠
]ùù≠ Æ
!=ùùØ ±
nullùù≤ ∂
&&ùù∑ π
xùù∫ ª
.ùùª º
Fieldsùùº ¬
[ùù¬ √
Sitecoreùù√ À
.ùùÀ Ã
FeatureùùÃ ”
.ùù” ‘
Libraryùù‘ €
.ùù€ ‹
	Templatesùù‹ Â
.ùùÂ Ê
	BaseFieldùùÊ Ô
.ùùÔ 
Fieldsùù ˆ
.ùùˆ ˜
_yearùù˜ ¸
]ùù¸ ˝
.ùù˝ ˛
Valueùù˛ É
==ùùÑ Ü
_Yearùùá å
)ùùå ç
;ùùç é
if
üü 
(
üü 
items
üü 
!=
üü 
null
üü !
&&
üü" $
items
üü% *
.
üü* +
Count
üü+ 0
(
üü0 1
)
üü1 2
>
üü3 4
$num
üü5 6
)
üü6 7
{
†† 
	listItems
°° 
.
°° 
Data
°° "
=
°°# $
items
°°% *
.
°°* +
Take
°°+ /
(
°°/ 0
$num
°°0 1
)
°°1 2
;
°°2 3
}
¢¢ 
	listItems
££ 
.
££ 
DataSourceID
££ &
=
££' (
RenderingContext
££) 9
.
££9 :
Current
££: A
.
££A B
	Rendering
££B K
.
££K L
Item
££L P
.
££P Q
ID
££Q S
;
££S T
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
)
•• 
{
•• 
}
••  !
return
ßß 
View
ßß 
(
ßß 
$str
ßß B
,
ßßB C
	listItems
ßßD M
)
ßßM N
;
ßßN O
}
®® 	
public
™™ 
ActionResult
™™ 

PromoStash
™™ &
(
™™& '
)
™™' (
{
´´ 	
int
≠≠ 
PageSize
≠≠ 
=
≠≠ 
RenderingContext
≠≠ +
.
≠≠+ ,
Current
≠≠, 3
.
≠≠3 4
	Rendering
≠≠4 =
.
≠≠= >!
GetIntegerParameter
≠≠> Q
(
≠≠Q R
$str
≠≠R \
,
≠≠\ ]
$num
≠≠^ _
)
≠≠_ `
;
≠≠` a
Sitecore
≤≤ 
.
≤≤ 
Data
≤≤ 
.
≤≤ 
Items
≤≤ 
.
≤≤  
Item
≤≤  $
dataSourceItem
≤≤% 3
=
≤≤4 5
RenderingContext
≤≤6 F
.
≤≤F G
Current
≤≤G N
.
≤≤N O
	Rendering
≤≤O X
.
≤≤X Y
Item
≤≤Y ]
;
≤≤] ^
	PagedData
¥¥ 
<
¥¥ 
Data
¥¥ 
.
¥¥ 
Items
¥¥  
.
¥¥  !
Item
¥¥! %
>
¥¥% &
	listItems
¥¥' 0
=
¥¥1 2
new
¥¥3 6
	PagedData
¥¥7 @
<
¥¥@ A
Data
¥¥A E
.
¥¥E F
Items
¥¥F K
.
¥¥K L
Item
¥¥L P
>
¥¥P Q
(
¥¥Q R
)
¥¥R S
;
¥¥S T
try
∂∂ 
{
∑∑ 
IEnumerable
ππ 
<
ππ 
Data
ππ  
.
ππ  !
Items
ππ! &
.
ππ& '
Item
ππ' +
>
ππ+ ,
items
ππ- 2
=
ππ3 4
this
ππ5 9
.
ππ9 :

Repository
ππ: D
.
ππD E
GetPromotion
ππE Q
(
ππQ R
dataSourceItem
ππR `
)
ππ` a
;
ππa b
if
∫∫ 
(
∫∫ 
items
∫∫ 
!=
∫∫ 
null
∫∫ !
&&
∫∫" $
items
∫∫% *
.
∫∫* +
Count
∫∫+ 0
(
∫∫0 1
)
∫∫1 2
>
∫∫3 4
$num
∫∫5 6
)
∫∫6 7
{
ªª 
	listItems
ºº 
.
ºº 
Data
ºº "
=
ºº# $
items
ºº% *
.
ºº* +
Take
ºº+ /
(
ºº/ 0
PageSize
ºº0 8
)
ºº8 9
;
ºº9 :
	listItems
ΩΩ 
.
ΩΩ 
NumberOfPages
ΩΩ +
=
ΩΩ, -
Convert
ΩΩ. 5
.
ΩΩ5 6
ToInt32
ΩΩ6 =
(
ΩΩ= >
Math
ΩΩ> B
.
ΩΩB C
Ceiling
ΩΩC J
(
ΩΩJ K
(
ΩΩK L
double
ΩΩL R
)
ΩΩR S
items
ΩΩS X
.
ΩΩX Y
Count
ΩΩY ^
(
ΩΩ^ _
)
ΩΩ_ `
/
ΩΩa b
PageSize
ΩΩc k
)
ΩΩk l
)
ΩΩl m
;
ΩΩm n
	listItems
ææ 
.
ææ 
CurrentPage
ææ )
=
ææ* +
$num
ææ, -
;
ææ- .
	listItems
øø 
.
øø 
PageSize
øø &
=
øø' (
PageSize
øø) 1
;
øø1 2
}
¿¿ 
	listItems
¡¡ 
.
¡¡ 
DataSourceID
¡¡ &
=
¡¡' (
RenderingContext
¡¡) 9
.
¡¡9 :
Current
¡¡: A
.
¡¡A B
	Rendering
¡¡B K
.
¡¡K L
Item
¡¡L P
.
¡¡P Q
ID
¡¡Q S
;
¡¡S T
}
√√ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
≈≈ 
return
∆∆ 
ErrorWebservice
∆∆ &
(
∆∆& '
new
∆∆' *"
JavaScriptSerializer
∆∆+ ?
(
∆∆? @
)
∆∆@ A
.
∆∆A B
	Serialize
∆∆B K
(
∆∆K L
new
∆∆L O
ReturnErrorData
∆∆P _
{
«« 
responseCode
»»  
=
»»! "
$str
»»# (
,
»»( )
descErrorCode
…… !
=
……" #
ex
……$ &
.
……& '
Message
……' .
.
……. /
ToString
……/ 7
(
……7 8
)
……8 9
}
   
)
   
)
   
;
   
}
ÀÀ 
return
ÕÕ 
View
ÕÕ 
(
ÕÕ 
$str
ÕÕ 7
,
ÕÕ7 8
	listItems
ÕÕ9 B
)
ÕÕB C
;
ÕÕC D
}
ŒŒ 	
public
–– 
ActionResult
–– "
PromoStashListPaging
–– 0
(
––0 1
int
––1 4
page
––5 9
,
––9 :
int
––; >
PageSize
––? G
,
––G H
string
––I O
id
––P R
)
––R S
{
—— 	
var
““ 
	listItems
““ 
=
““ 
new
““ 
	PagedData
““  )
<
““) *
Data
““* .
.
““. /
Items
““/ 4
.
““4 5
Item
““5 9
>
““9 :
(
““: ;
)
““; <
;
““< =
try
‘‘ 
{
’’ 
IEnumerable
÷÷ 
<
÷÷ 
Data
÷÷  
.
÷÷  !
Items
÷÷! &
.
÷÷& '
Item
÷÷' +
>
÷÷+ ,
items
÷÷- 2
=
÷÷3 4
this
÷÷5 9
.
÷÷9 :

Repository
÷÷: D
.
÷÷D E
GetPromotion
÷÷E Q
(
÷÷Q R
Sitecore
÷÷R Z
.
÷÷Z [
Context
÷÷[ b
.
÷÷b c
Database
÷÷c k
.
÷÷k l
GetItem
÷÷l s
(
÷÷s t
new
÷÷t w
Data
÷÷x |
.
÷÷| }
ID
÷÷} 
(÷÷ Ä
id÷÷Ä Ç
)÷÷Ç É
)÷÷É Ñ
)÷÷Ñ Ö
;÷÷Ö Ü
	listItems
ÿÿ 
.
ÿÿ 
Data
ÿÿ 
=
ÿÿ  
items
ÿÿ! &
.
ÿÿ& '
Skip
ÿÿ' +
(
ÿÿ+ ,
PageSize
ÿÿ, 4
*
ÿÿ5 6
(
ÿÿ7 8
page
ÿÿ8 <
-
ÿÿ= >
$num
ÿÿ? @
)
ÿÿ@ A
)
ÿÿA B
.
ÿÿB C
Take
ÿÿC G
(
ÿÿG H
PageSize
ÿÿH P
)
ÿÿP Q
;
ÿÿQ R
	listItems
ŸŸ 
.
ŸŸ 
NumberOfPages
ŸŸ '
=
ŸŸ( )
Convert
ŸŸ* 1
.
ŸŸ1 2
ToInt32
ŸŸ2 9
(
ŸŸ9 :
Math
ŸŸ: >
.
ŸŸ> ?
Ceiling
ŸŸ? F
(
ŸŸF G
(
ŸŸG H
double
ŸŸH N
)
ŸŸN O
items
ŸŸO T
.
ŸŸT U
Count
ŸŸU Z
(
ŸŸZ [
)
ŸŸ[ \
/
ŸŸ] ^
PageSize
ŸŸ_ g
)
ŸŸg h
)
ŸŸh i
;
ŸŸi j
	listItems
⁄⁄ 
.
⁄⁄ 
CurrentPage
⁄⁄ %
=
⁄⁄& '
page
⁄⁄( ,
;
⁄⁄, -
	listItems
€€ 
.
€€ 
DataSourceID
€€ &
=
€€' (
new
€€) ,
Data
€€- 1
.
€€1 2
ID
€€2 4
(
€€4 5
id
€€5 7
)
€€7 8
;
€€8 9
	listItems
‹‹ 
.
‹‹ 
PageSize
‹‹ "
=
‹‹# $
PageSize
‹‹% -
;
‹‹- .
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ 
ex
ﬁﬁ 
)
ﬁﬁ  
{
ﬂﬂ 
return
‡‡ 
ErrorWebservice
‡‡ &
(
‡‡& '
new
‡‡' *"
JavaScriptSerializer
‡‡+ ?
(
‡‡? @
)
‡‡@ A
.
‡‡A B
	Serialize
‡‡B K
(
‡‡K L
new
‡‡L O
ReturnErrorData
‡‡P _
{
·· 
responseCode
‚‚  
=
‚‚! "
$str
‚‚# (
,
‚‚( )
descErrorCode
„„ !
=
„„" #
ex
„„$ &
.
„„& '
Message
„„' .
.
„„. /
ToString
„„/ 7
(
„„7 8
)
„„8 9
}
‰‰ 
)
‰‰ 
)
‰‰ 
;
‰‰ 
}
ÂÂ 
return
ÁÁ 
PartialView
ÁÁ 
(
ÁÁ 
$str
ÁÁ >
,
ÁÁ> ?
	listItems
ÁÁ@ I
)
ÁÁI J
;
ÁÁJ K
}
ËË 	
public
ÎÎ 
ActionResult
ÎÎ 
MaybankBlogList
ÎÎ +
(
ÎÎ+ ,
)
ÎÎ, -
{
ÏÏ 	
string
ÌÌ 
	_category
ÌÌ 
=
ÌÌ 
Request
ÌÌ &
.
ÌÌ& '
QueryString
ÌÌ' 2
[
ÌÌ2 3
Sitecore
ÌÌ3 ;
.
ÌÌ; <
Feature
ÌÌ< C
.
ÌÌC D
Library
ÌÌD K
.
ÌÌK L
Helper
ÌÌL R
.
ÌÌR S
	Variables
ÌÌS \
.
ÌÌ\ ]
_categoryId
ÌÌ] h
]
ÌÌh i
!=
ÌÌj l
null
ÌÌm q
?
ÌÌr s
Request
ÌÌt {
.
ÌÌ{ |
QueryStringÌÌ| á
[ÌÌá à
SitecoreÌÌà ê
.ÌÌê ë
FeatureÌÌë ò
.ÌÌò ô
LibraryÌÌô †
.ÌÌ† °
HelperÌÌ° ß
.ÌÌß ®
	VariablesÌÌ® ±
.ÌÌ± ≤
_categoryIdÌÌ≤ Ω
]ÌÌΩ æ
.ÌÌæ ø
ToLowerÌÌø ∆
(ÌÌ∆ «
)ÌÌ« »
:ÌÌ…  
stringÌÌÀ —
.ÌÌ— “
EmptyÌÌ“ ◊
;ÌÌ◊ ÿ
var
ÓÓ 
PageSize
ÓÓ 
=
ÓÓ 
RenderingContext
ÓÓ +
.
ÓÓ+ ,
Current
ÓÓ, 3
.
ÓÓ3 4
	Rendering
ÓÓ4 =
.
ÓÓ= >!
GetIntegerParameter
ÓÓ> Q
(
ÓÓQ R
$str
ÓÓR \
,
ÓÓ\ ]
$num
ÓÓ^ _
)
ÓÓ_ `
;
ÓÓ` a
IEnumerable
ÔÔ 
<
ÔÔ 
Item
ÔÔ 
>
ÔÔ 
items
ÔÔ #
=
ÔÔ$ %
this
ÔÔ& *
.
ÔÔ* +

Repository
ÔÔ+ 5
.
ÔÔ5 6
GetMaybankBlog
ÔÔ6 D
(
ÔÔD E
RenderingContext
ÔÔE U
.
ÔÔU V
Current
ÔÔV ]
.
ÔÔ] ^
	Rendering
ÔÔ^ g
.
ÔÔg h
Item
ÔÔh l
)
ÔÔl m
;
ÔÔm n
if
ÚÚ 
(
ÚÚ 
	_category
ÚÚ 
!=
ÚÚ 
string
ÚÚ #
.
ÚÚ# $
Empty
ÚÚ$ )
)
ÚÚ) *
{
ÛÛ 
items
ÙÙ 
=
ÙÙ 
this
ÙÙ 
.
ÙÙ 

Repository
ÙÙ '
.
ÙÙ' (&
GetMaybankBlogByCategory
ÙÙ( @
(
ÙÙ@ A
items
ÙÙA F
,
ÙÙF G
	_category
ÙÙH Q
)
ÙÙQ R
;
ÙÙR S
}
ıı 
else
ˆˆ 
{
˜˜ 
Item
¯¯ 
defaultTabs
¯¯  
=
¯¯! "
Sitecore
¯¯# +
.
¯¯+ ,
Context
¯¯, 3
.
¯¯3 4
Database
¯¯4 <
.
¯¯< =
GetItem
¯¯= D
(
¯¯D E
Sitecore
¯¯E M
.
¯¯M N
Feature
¯¯N U
.
¯¯U V
Library
¯¯V ]
.
¯¯] ^
Helper
¯¯^ d
.
¯¯d e
	Variables
¯¯e n
.
¯¯n o"
MaybankBlogCategory¯¯o Ç
)¯¯Ç É
;¯¯É Ñ
	_category
˘˘ 
=
˘˘ 
Sitecore
˘˘ $
.
˘˘$ %
Feature
˘˘% ,
.
˘˘, -
Library
˘˘- 4
.
˘˘4 5
Helpers
˘˘5 <
.
˘˘< =
LibraryHelpers
˘˘= K
.
˘˘K L!
GetDynamicMultiList
˘˘L _
(
˘˘_ `
defaultTabs
˘˘` k
)
˘˘k l
.
˘˘l m
FirstOrDefault
˘˘m {
(
˘˘{ |
)
˘˘| }
.
˘˘} ~
ID˘˘~ Ä
.˘˘Ä Å
ToString˘˘Å â
(˘˘â ä
)˘˘ä ã
;˘˘ã å
items
˙˙ 
=
˙˙ 
this
˙˙ 
.
˙˙ 

Repository
˙˙ '
.
˙˙' (&
GetMaybankBlogByCategory
˙˙( @
(
˙˙@ A
items
˙˙A F
,
˙˙F G
	_category
˙˙H Q
)
˙˙Q R
;
˙˙R S
}
˚˚ 
var
˝˝ 
	listItems
˝˝ 
=
˝˝ 
new
˝˝ 
	PagedData
˝˝  )
<
˝˝) *
Data
˝˝* .
.
˝˝. /
Items
˝˝/ 4
.
˝˝4 5
Item
˝˝5 9
>
˝˝9 :
(
˝˝: ;
)
˝˝; <
;
˝˝< =
items
˛˛ 
=
˛˛ 
items
˛˛ 
==
˛˛ 
null
˛˛ !
?
˛˛" #
items
˛˛$ )
=
˛˛* +
new
˛˛, /
List
˛˛0 4
<
˛˛4 5
Item
˛˛5 9
>
˛˛9 :
(
˛˛: ;
)
˛˛; <
:
˛˛= >
items
˛˛? D
;
˛˛D E
if
ÄÄ 
(
ÄÄ 
items
ÄÄ 
!=
ÄÄ 
null
ÄÄ 
)
ÄÄ 
{
ÅÅ 
	listItems
ÇÇ 
.
ÇÇ 
Data
ÇÇ 
=
ÇÇ  
items
ÇÇ! &
.
ÇÇ& '
Take
ÇÇ' +
(
ÇÇ+ ,
PageSize
ÇÇ, 4
)
ÇÇ4 5
;
ÇÇ5 6
	listItems
ÉÉ 
.
ÉÉ 
NumberOfPages
ÉÉ '
=
ÉÉ( )
Convert
ÉÉ* 1
.
ÉÉ1 2
ToInt32
ÉÉ2 9
(
ÉÉ9 :
Math
ÉÉ: >
.
ÉÉ> ?
Ceiling
ÉÉ? F
(
ÉÉF G
(
ÉÉG H
double
ÉÉH N
)
ÉÉN O
items
ÉÉO T
.
ÉÉT U
Count
ÉÉU Z
(
ÉÉZ [
)
ÉÉ[ \
/
ÉÉ] ^
PageSize
ÉÉ_ g
)
ÉÉg h
)
ÉÉh i
;
ÉÉi j
	listItems
ÑÑ 
.
ÑÑ 
CurrentPage
ÑÑ %
=
ÑÑ& '
$num
ÑÑ( )
;
ÑÑ) *
	listItems
ÖÖ 
.
ÖÖ 
PageSize
ÖÖ "
=
ÖÖ# $
PageSize
ÖÖ% -
;
ÖÖ- .
	listItems
ÜÜ 
.
ÜÜ 
DataSourceID
ÜÜ &
=
ÜÜ' (
RenderingContext
ÜÜ) 9
.
ÜÜ9 :
Current
ÜÜ: A
.
ÜÜA B
	Rendering
ÜÜB K
.
ÜÜK L
Item
ÜÜL P
.
ÜÜP Q
ID
ÜÜQ S
;
ÜÜS T
}
áá 
return
àà 
this
àà 
.
àà 
View
àà 
(
àà 
$str
àà I
,
ààI J
	listItems
ààK T
)
ààT U
;
ààU V
}
ââ 	
public
ää 
ActionResult
ää #
MaybankBlogListPaging
ää 1
(
ää1 2
int
ää2 5
page
ää6 :
,
ää: ;
int
ää< ?
PageSize
ää@ H
,
ääH I
string
ääJ P
id
ääQ S
)
ääS T
{
ãã 	
var
åå 
	listItems
åå 
=
åå 
new
åå 
	PagedData
åå  )
<
åå) *
Data
åå* .
.
åå. /
Items
åå/ 4
.
åå4 5
Item
åå5 9
>
åå9 :
(
åå: ;
)
åå; <
;
åå< =
var
çç 
dataSourceItem
çç 
=
çç  
Sitecore
çç! )
.
çç) *
Context
çç* 1
.
çç1 2
Database
çç2 :
.
çç: ;
GetItem
çç; B
(
ççB C
new
ççC F
Data
ççG K
.
ççK L
ID
ççL N
(
ççN O
id
ççO Q
)
ççQ R
)
ççR S
;
ççS T
var
éé 
items
éé 
=
éé 
this
éé 
.
éé 

Repository
éé '
.
éé' (
GetMaybankBlog
éé( 6
(
éé6 7
dataSourceItem
éé7 E
)
ééE F
;
ééF G
items
èè 
=
èè 
this
èè 
.
èè 

Repository
èè #
.
èè# $
GetAllMaybankBlog
èè$ 5
(
èè5 6
items
èè6 ;
)
èè; <
;
èè< =
	listItems
êê 
.
êê 
Data
êê 
=
êê 
items
êê "
.
êê" #
Skip
êê# '
(
êê' (
PageSize
êê( 0
*
êê1 2
(
êê3 4
page
êê4 8
-
êê9 :
$num
êê; <
)
êê< =
)
êê= >
.
êê> ?
Take
êê? C
(
êêC D
PageSize
êêD L
)
êêL M
;
êêM N
	listItems
ëë 
.
ëë 
NumberOfPages
ëë #
=
ëë$ %
Convert
ëë& -
.
ëë- .
ToInt32
ëë. 5
(
ëë5 6
Math
ëë6 :
.
ëë: ;
Ceiling
ëë; B
(
ëëB C
(
ëëC D
double
ëëD J
)
ëëJ K
items
ëëK P
.
ëëP Q
Count
ëëQ V
(
ëëV W
)
ëëW X
/
ëëY Z
PageSize
ëë[ c
)
ëëc d
)
ëëd e
;
ëëe f
	listItems
íí 
.
íí 
CurrentPage
íí !
=
íí" #
page
íí$ (
;
íí( )
	listItems
ìì 
.
ìì 
DataSourceID
ìì "
=
ìì# $
new
ìì% (
Data
ìì) -
.
ìì- .
ID
ìì. 0
(
ìì0 1
id
ìì1 3
)
ìì3 4
;
ìì4 5
	listItems
îî 
.
îî 
PageSize
îî 
=
îî  
PageSize
îî! )
;
îî) *
return
ññ 
PartialView
ññ 
(
ññ 
$str
ññ L
,
ññL M
	listItems
ññN W
)
ññW X
;
ññX Y
}
óó 	
[
òò 	
Sitecore
òò	 
.
òò 
Feature
òò 
.
òò 
Content
òò !
.
òò! "
Helper
òò" (
.
òò( )*
ValidateAntiForgeryTokenPost
òò) E
]
òòE F
[
ôô 	
Sitecore
ôô	 
.
ôô 
Feature
ôô 
.
ôô 
Content
ôô !
.
ôô! "
Helper
ôô" (
.
ôô( )
PreventSpam
ôô) 4
]
ôô4 5
public
öö 
ActionResult
öö 
PostComment
öö '
(
öö' (
FormCollection
öö( 6
formData
öö7 ?
)
öö? @
{
õõ 	
Sitecore
úú 
.
úú 
Data
úú 
.
úú 
Items
úú 
.
úú  
Item
úú  $
blogItem
úú% -
=
úú. /
Sitecore
úú0 8
.
úú8 9
Context
úú9 @
.
úú@ A
Database
úúA I
.
úúI J
GetItem
úúJ Q
(
úúQ R
Sitecore
úúR Z
.
úúZ [
Feature
úú[ b
.
úúb c
Library
úúc j
.
úúj k
Helper
úúk q
.
úúq r
	Variables
úúr {
.
úú{ |
MaybankBlogItemúú| ã
)úúã å
;úúå ç
bool
ùù 
IsUseCaptcha
ùù 
=
ùù 
(
ùù  !
(
ùù! "
CheckboxField
ùù" /
)
ùù/ 0
blogItem
ùù0 8
.
ùù8 9
Fields
ùù9 ?
[
ùù? @
Sitecore
ùù@ H
.
ùùH I
Feature
ùùI P
.
ùùP Q
Library
ùùQ X
.
ùùX Y
	Templates
ùùY b
.
ùùb c
	BaseField
ùùc l
.
ùùl m
Fields
ùùm s
.
ùùs t
IsUseCaptchaùùt Ä
]ùùÄ Å
)ùùÅ Ç
.ùùÇ É
CheckedùùÉ ä
;ùùä ã
string
üü 
_userIP
üü 
=
üü 
string
üü #
.
üü# $
Empty
üü$ )
;
üü) *

GetIpValue
†† 
(
†† 
out
†† 
_userIP
†† "
)
††" #
;
††# $
BlogComment
££ 
blogComment
££ #
=
££$ %
new
££& )
BlogComment
££* 5
(
££5 6
)
££6 7
{
§§ 
ID
•• 
=
•• 
Guid
•• 
.
•• 
NewGuid
•• !
(
••! "
)
••" #
,
••# $
PageID
¶¶ 
=
¶¶ 
Request
¶¶  
.
¶¶  !
Form
¶¶! %
[
¶¶% &
$str
¶¶& .
]
¶¶. /
,
¶¶/ 0
PageDisplayName
ßß 
=
ßß  !
Request
ßß" )
.
ßß) *
Form
ßß* .
[
ßß. /
$str
ßß/ 9
]
ßß9 :
,
ßß: ;
Username
®® 
=
®® 
Request
®® "
.
®®" #
Form
®®# '
[
®®' (
$str
®®( 2
]
®®2 3
,
®®3 4
Email
©© 
=
©© 
Request
©© 
.
©©  
Form
©©  $
[
©©$ %
$str
©©% ,
]
©©, -
,
©©- .
Comment
™™ 
=
™™ 
Request
™™ !
.
™™! "
Form
™™" &
[
™™& '
$str
™™' 4
]
™™4 5
,
™™5 6
CommentDate
´´ 
=
´´ 
DateTime
´´ &
.
´´& '
Now
´´' *
,
´´* +
UserIP
¨¨ 
=
¨¨ 
_userIP
¨¨  
,
¨¨  !

isApproved
≠≠ 
=
≠≠ 
false
≠≠ "
,
≠≠" #
ApprovedDate
ÆÆ 
=
ÆÆ 
null
ÆÆ #
,
ÆÆ# $
isDelete
ØØ 
=
ØØ 
false
ØØ  
,
ØØ  !
DeletedDate
∞∞ 
=
∞∞ 
null
∞∞ "
}
±± 
;
±± 
if
≥≥ 
(
≥≥ 
IsUseCaptcha
≥≥ 
&&
≥≥ 
!
≥≥  !
IsReCaptchValid
≥≥! 0
(
≥≥0 1
)
≥≥1 2
)
≥≥2 3
{
¥¥ 
return
µµ 
ErrorWebservice
µµ &
(
µµ& ' 
SitecoreExtensions
µµ' 9
.
µµ9 :

Dictionary
µµ: D
(
µµD E
sitecoreHelper
µµE S
,
µµS T
$strµµU ä
,µµä ã
$strµµå ∞
)µµ∞ ±
)µµ± ≤
;µµ≤ ≥
}
∂∂ 
if
∏∏ 
(
∏∏ 
!
∏∏ 
isDelayPost
∏∏ 
(
∏∏ 
_userIP
∏∏ $
)
∏∏$ %
)
∏∏% &
{
ππ 
this
∫∫ 
.
∫∫ 

Repository
∫∫ 
.
∫∫  
PostComment
∫∫  +
(
∫∫+ ,
blogComment
∫∫, 7
)
∫∫7 8
;
∫∫8 9
}
ªª 
else
ºº 
{
ΩΩ 
return
ææ 
ErrorWebservice
ææ &
(
ææ& ' 
SitecoreExtensions
ææ' 9
.
ææ9 :

Dictionary
ææ: D
(
ææD E
sitecoreHelper
ææE S
,
ææS T
$str
ææU ~
,
ææ~ 
$strææÄ •
)ææ• ¶
)ææ¶ ß
;ææß ®
}
øø 
return
¿¿ 
Json
¿¿ 
(
¿¿ 
SuccessResponse
¿¿ '
(
¿¿' (
)
¿¿( )
,
¿¿) *!
JsonRequestBehavior
¿¿+ >
.
¿¿> ?
AllowGet
¿¿? G
)
¿¿G H
;
¿¿H I
}
¬¬ 	
[
√√ 	
Sitecore
√√	 
.
√√ 
Feature
√√ 
.
√√ 
Content
√√ !
.
√√! "
Helper
√√" (
.
√√( )*
ValidateAntiForgeryTokenPost
√√) E
]
√√E F
public
ƒƒ 
ActionResult
ƒƒ $
LoadAllCommentByBlogId
ƒƒ 2
(
ƒƒ2 3
string
ƒƒ3 9
blogId
ƒƒ: @
,
ƒƒ@ A
int
ƒƒB E
index
ƒƒF K
)
ƒƒK L
{
≈≈ 	
return
∆∆ 
Json
∆∆ 
(
∆∆ 
this
∆∆ 
.
∆∆ 

Repository
∆∆ '
.
∆∆' ($
LoadAllCommentByBlogId
∆∆( >
(
∆∆> ?
blogId
∆∆? E
,
∆∆E F
index
∆∆G L
)
∆∆L M
,
∆∆M N!
JsonRequestBehavior
∆∆O b
.
∆∆b c
AllowGet
∆∆c k
)
∆∆k l
;
∆∆l m
}
«« 	
public
»» 
ActionResult
»» &
GetAllNotApprovedComment
»» 4
(
»»4 5
)
»»5 6
{
…… 	
return
   
Json
   
(
   
this
   
.
   

Repository
   '
.
  ' (&
GetAllNotApprovedComment
  ( @
(
  @ A
)
  A B
,
  B C!
JsonRequestBehavior
  D W
.
  W X
AllowGet
  X `
)
  ` a
;
  a b
}
ÀÀ 	
[
œœ 	
	NonAction
œœ	 
]
œœ 
public
–– 
ActionResult
–– 
ErrorWebservice
–– +
(
––+ ,
string
––, 2
responseError
––3 @
)
––@ A
{
—— 	
Response
”” 
.
”” 

StatusCode
”” 
=
””  !
$num
””" %
;
””% &
Response
‘‘ 
.
‘‘ 
Write
‘‘ 
(
‘‘ 
responseError
‘‘ (
)
‘‘( )
;
‘‘) *
Response
’’ 
.
’’ $
TrySkipIisCustomErrors
’’ +
=
’’, -
true
’’. 2
;
’’2 3
Response
÷÷ 
.
÷÷ 
End
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
return
◊◊ 
new
◊◊ 
EmptyResult
◊◊ "
(
◊◊" #
)
◊◊# $
;
◊◊$ %
}
ÿÿ 	
[
⁄⁄ 	
	NonAction
⁄⁄	 
]
⁄⁄ 
public
€€ 
ActionResult
€€ 
SuccessResponse
€€ +
(
€€+ ,
)
€€, -
{
‹‹ 	
Response
›› 
.
›› 

StatusCode
›› 
=
››  !
$num
››" %
;
››% &
Response
ﬁﬁ 
.
ﬁﬁ $
TrySkipIisCustomErrors
ﬁﬁ +
=
ﬁﬁ, -
true
ﬁﬁ. 2
;
ﬁﬁ2 3
Response
ﬂﬂ 
.
ﬂﬂ $
TrySkipIisCustomErrors
ﬂﬂ +
=
ﬂﬂ, -
true
ﬂﬂ. 2
;
ﬂﬂ2 3
Response
‡‡ 
.
‡‡ 
End
‡‡ 
(
‡‡ 
)
‡‡ 
;
‡‡ 
return
·· 
new
·· 
EmptyResult
·· "
(
··" #
)
··# $
;
··$ %
}
‚‚ 	
[
‰‰ 	
	NonAction
‰‰	 
]
‰‰ 
private
ÂÂ 
bool
ÂÂ 
IsReCaptchValid
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
{
ÊÊ 	
if
ÁÁ 
(
ÁÁ 
Request
ÁÁ 
.
ÁÁ 
Form
ÁÁ 
[
ÁÁ 
$str
ÁÁ 3
]
ÁÁ3 4
==
ÁÁ5 7
null
ÁÁ8 <
)
ÁÁ< =
{
ËË 
return
ÈÈ 
false
ÈÈ 
;
ÈÈ 
}
ÍÍ 
var
ÏÏ 
result
ÏÏ 
=
ÏÏ 
false
ÏÏ 
;
ÏÏ 
var
ÌÌ 
captchaResponse
ÌÌ 
=
ÌÌ  !
Request
ÌÌ" )
.
ÌÌ) *
Form
ÌÌ* .
[
ÌÌ. /
$str
ÌÌ/ E
]
ÌÌE F
;
ÌÌF G
Config
ÓÓ 
config
ÓÓ 
=
ÓÓ 
new
ÓÓ 
Config
ÓÓ  &
(
ÓÓ& '
)
ÓÓ' (
;
ÓÓ( )
var
ÔÔ 
	secretKey
ÔÔ 
=
ÔÔ 
config
ÔÔ "
.
ÔÔ" #
	SecretKey
ÔÔ# ,
;
ÔÔ, -
var
 
apiUrl
 
=
 "
ConfigurationManager
 -
.
- .
ConnectionStrings
. ?
[
? @
$str
@ V
]
V W
.
W X
ToString
X `
(
` a
)
a b
;
b c
apiUrl
ÒÒ 
=
ÒÒ 
apiUrl
ÒÒ 
+
ÒÒ 
$str
ÒÒ 7
;
ÒÒ7 8
var
ÚÚ 

requestUri
ÚÚ 
=
ÚÚ 
string
ÚÚ #
.
ÚÚ# $
Format
ÚÚ$ *
(
ÚÚ* +
apiUrl
ÚÚ+ 1
,
ÚÚ1 2
	secretKey
ÚÚ3 <
,
ÚÚ< =
captchaResponse
ÚÚ> M
)
ÚÚM N
;
ÚÚN O
var
ÛÛ 
httpWebRequest
ÛÛ 
=
ÛÛ  
(
ÛÛ! "
HttpWebRequest
ÛÛ" 0
)
ÛÛ0 1

WebRequest
ÛÛ1 ;
.
ÛÛ; <
Create
ÛÛ< B
(
ÛÛB C

requestUri
ÛÛC M
)
ÛÛM N
;
ÛÛN O
try
ıı 
{
ˆˆ 
using
˜˜ 
(
˜˜ 
WebResponse
˜˜ "
response
˜˜# +
=
˜˜, -
httpWebRequest
˜˜. <
.
˜˜< =
GetResponse
˜˜= H
(
˜˜H I
)
˜˜I J
)
˜˜J K
{
¯¯ 
using
˘˘ 
(
˘˘ 
StreamReader
˘˘ '
stream
˘˘( .
=
˘˘/ 0
new
˘˘1 4
StreamReader
˘˘5 A
(
˘˘A B
response
˘˘B J
.
˘˘J K
GetResponseStream
˘˘K \
(
˘˘\ ]
)
˘˘] ^
)
˘˘^ _
)
˘˘_ `
{
˙˙ 
JObject
˚˚ 
	jResponse
˚˚  )
=
˚˚* +
JObject
˚˚, 3
.
˚˚3 4
Parse
˚˚4 9
(
˚˚9 :
stream
˚˚: @
.
˚˚@ A
	ReadToEnd
˚˚A J
(
˚˚J K
)
˚˚K L
)
˚˚L M
;
˚˚M N
result
¸¸ 
=
¸¸  
	jResponse
¸¸! *
.
¸¸* +
Value
¸¸+ 0
<
¸¸0 1
bool
¸¸1 5
>
¸¸5 6
(
¸¸6 7
$str
¸¸7 @
)
¸¸@ A
;
¸¸A B
}
˛˛ 
}
ˇˇ 
}
ÄÄ 
catch
ÅÅ 
{
ÇÇ 
return
ÉÉ 
false
ÉÉ 
;
ÉÉ 
}
ÑÑ 
return
ÖÖ 
result
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
[
áá 	
	NonAction
áá	 
]
áá 
private
àà 
void
àà 

GetIpValue
àà 
(
àà  
out
àà  #
string
àà$ *
ipAdd
àà+ 0
)
àà0 1
{
ââ 	
ipAdd
ää 
=
ää 
Request
ää 
.
ää 
ServerVariables
ää +
[
ää+ ,
$str
ää, B
]
ääB C
;
ääC D
if
åå 
(
åå 
string
åå 
.
åå 
IsNullOrEmpty
åå $
(
åå$ %
ipAdd
åå% *
)
åå* +
)
åå+ ,
{
çç 
ipAdd
éé 
=
éé 
Request
éé 
.
éé  
ServerVariables
éé  /
[
éé/ 0
$str
éé0 =
]
éé= >
;
éé> ?
}
èè 
else
êê 
{
ëë 
ipAdd
íí 
=
íí 
Request
íí 
.
íí  
UserHostAddress
íí  /
;
íí/ 0
}
ìì 
}
îî 	
[
ïï 	
	NonAction
ïï	 
]
ïï 
private
ññ 
bool
ññ 
isDelayPost
ññ  
(
ññ  !
string
ññ! '
userIP
ññ( .
)
ññ. /
{
óó 	
bool
òò 
isDelay
òò 
=
òò 
false
òò  
;
òò  !
using
ôô 
(
ôô 
var
ôô 
db
ôô 
=
ôô 
Factory
ôô #
.
ôô# $

DbEntities
ôô$ .
)
ôô. /
{
öö 
try
õõ 
{
úú 
SqlParameter
ùù  
paramMaxComment
ùù! 0
=
ùù1 2
new
ùù3 6
SqlParameter
ùù7 C
(
ùùC D
$str
ùùD Q
,
ùùQ R 
SitecoreExtensions
ùùS e
.
ùùe f

Dictionary
ùùf p
(
ùùp q
sitecoreHelper
ùùq 
,ùù Ä
$strùùÅ §
,ùù§ •
$strùù¶ ©
)ùù© ™
)ùù™ ´
;ùù´ ¨
SqlParameter
ûû  
paramDelayTime
ûû! /
=
ûû0 1
new
ûû2 5
SqlParameter
ûû6 B
(
ûûB C
$str
ûûC O
,
ûûO P 
SitecoreExtensions
ûûQ c
.
ûûc d

Dictionary
ûûd n
(
ûûn o
sitecoreHelper
ûûo }
,
ûû} ~
$strûû °
,ûû° ¢
$strûû£ ™
)ûû™ ´
)ûû´ ¨
;ûû¨ ≠
SqlParameter
üü  
paramUserIP
üü! ,
=
üü- .
new
üü/ 2
SqlParameter
üü3 ?
(
üü? @
$str
üü@ I
,
üüI J
userIP
üüK Q
)
üüQ R
;
üüR S
isDelay
†† 
=
†† 
Convert
†† %
.
††% &
	ToBoolean
††& /
(
††/ 0
db
††0 2
.
††2 3
Database
††3 ;
.
††; <
SqlQuery
††< D
<
††D E
int
††E H
>
††H I
(
††I J
$str††J Ñ
,††Ñ Ö
paramMaxComment††Ü ï
,††ï ñ
paramDelayTime††ó •
,††• ¶
paramUserIP††ß ≤
)††≤ ≥
.††≥ ¥
FirstOrDefault††¥ ¬
(††¬ √
)††√ ƒ
)††ƒ ≈
;††≈ ∆
}
°° 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢  
ex
¢¢! #
)
¢¢# $
{
££ 
ErrorWebservice
§§ #
(
§§# $
ex
§§$ &
.
§§& '
Message
§§' .
.
§§. /
ToString
§§/ 7
(
§§7 8
)
§§8 9
)
§§9 :
;
§§: ;
}
•• 
return
¶¶ 
isDelay
¶¶ 
;
¶¶ 
}
ßß 
}
®® 	
}
™™ 
}´´ ƒ
<C:\Review Code\Maybank Blog\Content\code\Helper\DBContext.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Helper# )
{ 
public 

class 
	DBContext 
: 
	DbContext &
{ 
public 
	DBContext 
( 
) 
:		 
base		 
(		 
$str		 )
)		) *
{

 	
} 	
public 
	DBContext 
( 
string 
	constring  )
)) *
: 
base 
( 
	constring 
) 
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
DbModelBuilder0 >
modelBuilder? K
)K L
{ 	
modelBuilder 
. 
Conventions $
.$ %
Remove% +
<+ ,*
PluralizingTableNameConvention, J
>J K
(K L
)L M
;M N
Database 
. 
SetInitializer #
<# $
	DBContext$ -
>- .
(. /
null/ 3
)3 4
;4 5
} 	
public 
DbSet 
< 
BlogComment  
>  !
BlogComment" -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} ®
:C:\Review Code\Maybank Blog\Content\code\Helper\Factory.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Helper# )
{ 
public		 

class		 
Factory		 
{

 
public 
static 
	libHelper 
.  
Config  &
libHelperCfg' 3
=4 5
new6 9
	libHelper: C
.C D
ConfigD J
(J K
)K L
;L M
public 
static 
	DBContext 

DbEntities  *
{ 	
get 
{ 
return 
new 
	DBContext $
($ %
DBConstring% 0
)0 1
;1 2
} 
} 	
public 
static 
string 
DBConstring (
=) *
libHelperCfg+ 7
.7 8
ConectionString8 G
;G H
} 
} úD
GC:\Review Code\Maybank Blog\Content\code\Helper\PreventSpamAttribute.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Helper# )
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Class% *
|+ ,
AttributeTargets- =
.= >
Method> D
,D E
AllowMultipleF S
=T U
trueV Z
)Z [
][ \
public 

class  
PreventSpamAttribute %
:& '!
ActionFilterAttribute( =
{ 
private 
static 
Sitecore 
.  
Mvc  #
.# $
Helpers$ +
.+ ,
SitecoreHelper, :
sitecoreHelper; I
;I J
private 
static 
Sitecore 
.  
Mvc  #
.# $
Helpers$ +
.+ ,
SitecoreHelper, :
SitecoreHelper; I
{ 	
get 
{ 
if 
( 
sitecoreHelper "
==# %
null& *
)* +
{ 
sitecoreHelper "
=# $
Sitecore 
. 
Mvc "
." #
Helpers# *
.* +
ThreadHelper+ 7
.7 8
GetThreadData8 E
<E F
SitecoreF N
.N O
MvcO R
.R S
HelpersS Z
.Z [
SitecoreHelper[ i
>i j
(j k
)k l
;l m
} 
if 
( 
sitecoreHelper "
==# %
null& *
)* +
{   
ViewContext!! 
viewContext!!  +
=!!, -
Sitecore!!. 6
.!!6 7
Mvc!!7 :
.!!: ;
Common!!; A
.!!A B
ContextService!!B P
.!!P Q
Get!!Q T
(!!T U
)!!U V
.!!V W

GetCurrent!!W a
<!!a b
ViewContext!!b m
>!!m n
(!!n o
)!!o p
;!!p q
Sitecore"" 
."" 
Diagnostics"" (
.""( )
Assert"") /
.""/ 0
	IsNotNull""0 9
(""9 :
viewContext"": E
,""E F
$str""G T
)""T U
;""U V

HtmlHelper## 

htmlHelper## )
=##* +
new##, /

HtmlHelper##0 :
(##: ;
viewContext$$ !
,$$! "
new%% 
Sitecore%% "
.%%" #
Mvc%%# &
.%%& '
Presentation%%' 3
.%%3 4
ViewDataContainer%%4 E
(%%E F
viewContext%%F Q
.%%Q R
ViewData%%R Z
)%%Z [
)%%[ \
;%%\ ]
Sitecore&& 
.&& 
Diagnostics&& (
.&&( )
Assert&&) /
.&&/ 0
	IsNotNull&&0 9
(&&9 :

htmlHelper&&: D
,&&D E
$str&&F R
)&&R S
;&&S T
sitecoreHelper'' "
=''# $
new''% (
Sitecore'') 1
.''1 2
Mvc''2 5
.''5 6
Helpers''6 =
.''= >
SitecoreHelper''> L
(''L M

htmlHelper''M W
)''W X
;''X Y
Sitecore(( 
.(( 
Diagnostics(( (
.((( )
Assert(() /
.((/ 0
	IsNotNull((0 9
(((9 :
sitecoreHelper((: H
,((H I
$str((J Z
)((Z [
;(([ \
Sitecore)) 
.)) 
Mvc))  
.))  !
Helpers))! (
.))( )
ThreadHelper))) 5
.))5 6
SetThreadData))6 C
<))C D
Sitecore))D L
.))L M
Mvc))M P
.))P Q
Helpers))Q X
.))X Y
SitecoreHelper))Y g
>))g h
())h i
sitecoreHelper** $
)**$ %
;**% &
}++ 
return-- 
sitecoreHelper-- %
;--% &
}.. 
}// 	
private11 
readonly11 
int11 
DelayRequest11 )
=11* +
System11, 2
.112 3
Convert113 :
.11: ;
ToInt3211; B
(11B C 
ConfigurationManager11C W
.11W X
ConnectionStrings11X i
[11i j
$str	11j Ç
]
11Ç É
.
11É Ñ
ToString
11Ñ å
(
11å ç
)
11ç é
)
11é è
;
11è ê
private33 
readonly33 
string33 
ErrorMessage33  ,
=33- .
SitecoreExtensions33/ A
.33A B

Dictionary33B L
(33L M
sitecoreHelper33M [
,33[ \
$str	33] Ü
,
33Ü á
$str
33à ≠
)
33≠ Æ
;
33Æ Ø
public55 
override55 
void55 
OnActionExecuting55 .
(55. /"
ActionExecutingContext55/ E
filterContext55F S
)55S T
{66 	
var88 
request88 
=88 
filterContext88 '
.88' (
HttpContext88( 3
.883 4
Request884 ;
;88; <
var:: 
cache:: 
=:: 
filterContext:: %
.::% &
HttpContext::& 1
.::1 2
Cache::2 7
;::7 8
var== 
originationInfo== 
===  !
request==" )
.==) *
ServerVariables==* 9
[==9 :
$str==: P
]==P Q
??==R T
request==U \
.==\ ]
UserHostAddress==] l
;==l m
originationInfo@@ 
+=@@ 
request@@ &
.@@& '
	UserAgent@@' 0
;@@0 1
varCC 

targetInfoCC 
=CC 
requestCC $
.CC$ %
RawUrlCC% +
+CC, -
requestCC. 5
.CC5 6
QueryStringCC6 A
;CCA B
varFF 
	hashValueFF 
=FF 
stringFF "
.FF" #
JoinFF# '
(FF' (
$strFF( *
,FF* +
MD5FF, /
.FF/ 0
CreateFF0 6
(FF6 7
)FF7 8
.FF8 9
ComputeHashFF9 D
(FFD E
EncodingFFE M
.FFM N
ASCIIFFN S
.FFS T
GetBytesFFT \
(FF\ ]
originationInfoFF] l
+FFm n

targetInfoFFo y
)FFy z
)FFz {
.FF{ |
Select	FF| Ç
(
FFÇ É
s
FFÉ Ñ
=>
FFÖ á
s
FFà â
.
FFâ ä
ToString
FFä í
(
FFí ì
$str
FFì ó
)
FFó ò
)
FFò ô
)
FFô ö
;
FFö õ
ifII 
(II 
cacheII 
[II 
	hashValueII 
]II  
!=II! #
nullII$ (
)II( )
{JJ 
filterContextLL 
.LL 
HttpContextLL )
.LL) *
ResponseLL* 2
.LL2 3

StatusCodeLL3 =
=LL> ?
$numLL@ C
;LLC D
filterContextMM 
.MM 
HttpContextMM )
.MM) *
ResponseMM* 2
.MM2 3
WriteMM3 8
(MM8 9
ErrorMessageMM9 E
)MME F
;MMF G
filterContextNN 
.NN 
HttpContextNN )
.NN) *
ResponseNN* 2
.NN2 3"
TrySkipIisCustomErrorsNN3 I
=NNJ K
trueNNL P
;NNP Q
filterContextOO 
.OO 
ResultOO $
=OO% &
newOO' *
EmptyResultOO+ 6
(OO6 7
)OO7 8
;OO8 9
filterContextPP 
.PP 
HttpContextPP )
.PP) *
ResponsePP* 2
.PP2 3
EndPP3 6
(PP6 7
)PP7 8
;PP8 9
}QQ 
elseRR 
{SS 
cacheVV 
.VV 
AddVV 
(VV 
	hashValueVV #
,VV# $
$strVV% 7
,VV7 8
nullVV9 =
,VV= >
DateTimeVV? G
.VVG H
NowVVH K
.VVK L

AddSecondsVVL V
(VVV W
DelayRequestVVW c
)VVc d
,VVd e
CacheVVf k
.VVk l
NoSlidingExpirationVVl 
,	VV Ä
CacheItemPriority
VVÅ í
.
VVí ì
Default
VVì ö
,
VVö õ
null
VVú †
)
VV† °
;
VV° ¢
}WW 
baseYY 
.YY 
OnActionExecutingYY "
(YY" #
filterContextYY# 0
)YY0 1
;YY1 2
}ZZ 	
}[[ 
}\\ ù 
XC:\Review Code\Maybank Blog\Content\code\Helper\ValidateAntiForgeryTokenPostAttribute.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Helper# )
{ 
[		 
AttributeUsage		 
(		 
AttributeTargets		 $
.		$ %
Class		% *
|		+ ,
AttributeTargets		- =
.		= >
Method		> D
,		D E
AllowMultiple		F S
=		T U
true		V Z
)		Z [
]		[ \
public

 

class

 1
%ValidateAntiForgeryTokenPostAttribute

 6
:

7 8
AuthorizeAttribute

9 K
{ 
public 
override 
void 
OnAuthorization ,
(, - 
AuthorizationContext- A
filterContextB O
)O P
{ 	
var 
request 
= 
filterContext '
.' (
HttpContext( 3
.3 4
Request4 ;
;; <
if 
( 
request 
. 

HttpMethod "
==# %
WebRequestMethods& 7
.7 8
Http8 <
.< =
Post= A
)A B
{ 
if 
( 
request 
. 
IsAjaxRequest )
() *
)* +
)+ ,
{ 
var 
antiForgeryCookie )
=* +
request, 3
.3 4
Cookies4 ;
[; <
AntiForgeryConfig< M
.M N

CookieNameN X
]X Y
;Y Z
var 
cookieValue #
=$ %
antiForgeryCookie& 7
!=8 :
null; ?
? 
antiForgeryCookie +
.+ ,
Value, 1
: 
null 
; 
if 
( 
request 
.  
Headers  '
[' (
$str( D
]D E
!=F H
nullI M
)M N
AntiForgery #
.# $
Validate$ ,
(, -
cookieValue- 8
,8 9
request: A
.A B
HeadersB I
[I J
$strJ f
]f g
)g h
;h i
else 
{   
filterContext!! %
.!!% &
HttpContext!!& 1
.!!1 2
Response!!2 :
.!!: ;

StatusCode!!; E
=!!F G
$num!!H K
;!!K L
filterContext"" %
.""% &
HttpContext""& 1
.""1 2
Response""2 :
."": ;
Write""; @
(""@ A
new""A D 
JavaScriptSerializer""E Y
(""Y Z
)""Z [
.""[ \
	Serialize""\ e
(""e f
new""f i
ReturnErrorData""j y
{## 
responseCode$$ (
=$$) *
$str$$+ 0
,$$0 1
descErrorCode%% )
=%%* +
$str%%, M
,%%M N
descErrorCodeEN&& +
=&&, -
$str&&. O
}'' 
)'' 
)'' 
;'' 
filterContext(( %
.((% &
HttpContext((& 1
.((1 2
Response((2 :
.((: ;"
TrySkipIisCustomErrors((; Q
=((R S
true((T X
;((X Y
filterContext)) %
.))% &
Result))& ,
=))- .
new))/ 2
EmptyResult))3 >
())> ?
)))? @
;))@ A
filterContext** %
.**% &
HttpContext**& 1
.**1 2
Response**2 :
.**: ;
End**; >
(**> ?
)**? @
;**@ A
}++ 
},, 
else-- 
{.. 
new// -
!ValidateAntiForgeryTokenAttribute// 9
(//9 :
)//: ;
.00 
OnAuthorization00 (
(00( )
filterContext00) 6
)006 7
;007 8
}11 
}22 
}33 	
}44 
}55 ¶
IC:\Review Code\Maybank Blog\Content\code\Indexing\BlogIndexingProvider.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Indexing# +
{ 
public 

class  
BlogIndexingProvider %
:& '
ProviderBase( 4
,4 5"
ISearchResultFormatter6 L
,L M#
IQueryPredicateProviderN e
{ 
public 

Expression 
< 
Func 
< 
SearchResultItem /
,/ 0
bool1 5
>5 6
>6 7
GetQueryPredicate8 I
(I J
IQueryJ P
queryQ V
)V W
{ 	
var 

fieldNames 
= 
new  
[  !
]! "
{# $
	Templates% .
.. /
	BaseField/ 8
.8 9
Fields9 ?
.? @
stringTitle@ K
}L M
;M N
return '
GetFreeTextPredicateService .
.. / 
GetFreeTextPredicate/ C
(C D

fieldNamesD N
,N O
queryP U
)U V
;V W
} 	
public 
string 
ContentType !
=>" $
$str% +
;+ ,
public 
IEnumerable 
< 
ID 
> 
SupportedTemplates 1
=>2 4
new5 8
[8 9
]9 :
{; <
	Templates= F
.F G
MBMBlogPageG R
.R S
IDS U
,V W
	TemplatesX a
.a b
MBMArticlePageb p
.p q
IDq s
}t u
;u v
public 
void 
FormatResult  
(  !
SearchResultItem! 1
item2 6
,6 7
ISearchResult8 E
formattedResultF U
)U V
{ 	
var 
contentItem 
= 
item "
." #
GetItem# *
(* +
)+ ,
;, -
if 
( 
contentItem 
== 
null #
)# $
{ 
return 
; 
}   
formattedResult"" 
."" 
Title"" !
=""" #
FieldRenderer""$ 1
.""1 2
Render""2 8
(""8 9
contentItem""9 D
,""D E
	Templates""F O
.""O P
	BaseField""P Y
.""Y Z
Fields""Z `
.""` a
Title""a f
.""f g
ToString""g o
(""o p
)""p q
)""q r
;""r s
}## 	
}$$ 
}%% å
>C:\Review Code\Maybank Blog\Content\code\Models\BlogComment.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Models# )
{ 
public 

class 
BlogComment 
{ 
[ 	
Key	 
] 
public 
Guid 
ID 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
PageID		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
string

 
PageDisplayName

 %
{

& '
get

( +
;

+ ,
set

- 0
;

0 1
}

2 3
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Comment 
{ 
get  #
;# $
set% (
;( )
}* +
public 
DateTime 
CommentDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
UserIP 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 

isApproved 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
DateTime 
? 
ApprovedDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
bool 
isDelete 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
DeletedDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ParentId 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ¨
AC:\Review Code\Maybank Blog\Content\code\Models\BlogCommentDto.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Models# )
{ 
public 

class 
BlogCommentDto 
{ 
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Comment 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
DateTime		 
CommentDate		 #
{		$ %
get		& )
;		) *
set		+ .
;		. /
}		0 1
}

 
} ∫
BC:\Review Code\Maybank Blog\Content\code\Models\ReturnErrorData.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Models# )
{ 
public 

class 
ReturnErrorData  
{ 
public 
string 
responseCode "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
descErrorCode #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
descErrorCodeEN %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
}		 Ó
CC:\Review Code\Maybank Blog\Content\code\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 3
)3 4
]4 5
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 5
)5 6
]6 7
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[%% 
assembly%% 	
:%%	 

AssemblyVersion%% 
(%% 
$str%% $
)%%$ %
]%%% &
[&& 
assembly&& 	
:&&	 

AssemblyFileVersion&& 
(&& 
$str&& (
)&&( )
]&&) *≠®
GC:\Review Code\Maybank Blog\Content\code\Repositories\BlogRepository.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Repositories# /
{ 
[ 
Service 
( 
typeof 
( 
IBlogRepository #
)# $
)$ %
]% &
public 

class 
BlogRepository 
:  !
IBlogRepository" 1
{ 
private 
readonly $
ISearchServiceRepository 1#
searchServiceRepository2 I
;I J
public 
BlogRepository 
( $
ISearchServiceRepository 6#
searchServiceRepository7 N
)N O
{ 	
this 
. #
searchServiceRepository (
=) *#
searchServiceRepository+ B
;B C
} 	
private!! 
static!! 
Sitecore!! 
.!!  
Mvc!!  #
.!!# $
Helpers!!$ +
.!!+ ,
SitecoreHelper!!, :
sitecoreHelper!!; I
;!!I J
private## 
static## 
Sitecore## 
.##  
Mvc##  #
.### $
Helpers##$ +
.##+ ,
SitecoreHelper##, :
SitecoreHelper##; I
{$$ 	
get%% 
{&& 
if'' 
('' 
sitecoreHelper'' "
==''# %
null''& *
)''* +
{(( 
sitecoreHelper)) "
=))# $
Sitecore** 
.** 
Mvc** "
.**" #
Helpers**# *
.*** +
ThreadHelper**+ 7
.**7 8
GetThreadData**8 E
<**E F
Sitecore**F N
.**N O
Mvc**O R
.**R S
Helpers**S Z
.**Z [
SitecoreHelper**[ i
>**i j
(**j k
)**k l
;**l m
}++ 
if-- 
(-- 
sitecoreHelper-- "
==--# %
null--& *
)--* +
{.. 
ViewContext// 
viewContext//  +
=//, -
Sitecore//. 6
.//6 7
Mvc//7 :
.//: ;
Common//; A
.//A B
ContextService//B P
.//P Q
Get//Q T
(//T U
)//U V
.//V W

GetCurrent//W a
<//a b
ViewContext//b m
>//m n
(//n o
)//o p
;//p q
Sitecore00 
.00 
Diagnostics00 (
.00( )
Assert00) /
.00/ 0
	IsNotNull000 9
(009 :
viewContext00: E
,00E F
$str00G T
)00T U
;00U V

HtmlHelper11 

htmlHelper11 )
=11* +
new11, /

HtmlHelper110 :
(11: ;
viewContext22 !
,22! "
new33 
Sitecore33 "
.33" #
Mvc33# &
.33& '
Presentation33' 3
.333 4
ViewDataContainer334 E
(33E F
viewContext33F Q
.33Q R
ViewData33R Z
)33Z [
)33[ \
;33\ ]
Sitecore44 
.44 
Diagnostics44 (
.44( )
Assert44) /
.44/ 0
	IsNotNull440 9
(449 :

htmlHelper44: D
,44D E
$str44F R
)44R S
;44S T
sitecoreHelper55 "
=55# $
new55% (
Sitecore55) 1
.551 2
Mvc552 5
.555 6
Helpers556 =
.55= >
SitecoreHelper55> L
(55L M

htmlHelper55M W
)55W X
;55X Y
Sitecore66 
.66 
Diagnostics66 (
.66( )
Assert66) /
.66/ 0
	IsNotNull660 9
(669 :
sitecoreHelper66: H
,66H I
$str66J Z
)66Z [
;66[ \
Sitecore77 
.77 
Mvc77  
.77  !
Helpers77! (
.77( )
ThreadHelper77) 5
.775 6
SetThreadData776 C
<77C D
Sitecore77D L
.77L M
Mvc77M P
.77P Q
Helpers77Q X
.77X Y
SitecoreHelper77Y g
>77g h
(77h i
sitecoreHelper88 $
)88$ %
;88% &
}99 
return;; 
sitecoreHelper;; %
;;;% &
}<< 
}== 	
public?? 
IEnumerable?? 
<?? 
Item?? 
>??  
Get??! $
(??$ %
Item??% )
contextItem??* 5
)??5 6
{@@ 	
ifAA 
(AA 
contextItemAA 
==AA 
nullAA #
)AA# $
{BB 
throwCC 
newCC !
ArgumentNullExceptionCC /
(CC/ 0
nameofCC0 6
(CC6 7
contextItemCC7 B
)CCB C
)CCC D
;CCD E
}DD 
ifEE 
(EE 
!EE 
contextItemEE 
.EE 
	IsDerivedEE &
(EE& '
	TemplatesEE' 0
.EE0 1
BucketMBMBlogEE1 >
.EE> ?
IDEE? A
)EEA B
)EEB C
{FF 
throwGG 
newGG 
ArgumentExceptionGG +
(GG+ ,
$strGG, Q
,GGQ R
nameofGGS Y
(GGY Z
contextItemGGZ e
)GGe f
)GGf g
;GGg h
}HH 
varJJ 
searchServiceJJ 
=JJ 
thisJJ  $
.JJ$ %#
searchServiceRepositoryJJ% <
.JJ< =
GetJJ= @
(JJ@ A
newJJA D
SearchSettingsBaseJJE W
{JJX Y
	TemplatesJJZ c
=JJd e
newJJf i
[JJi j
]JJj k
{JJl m
	TemplatesJJn w
.JJw x
MBMBlogPage	JJx É
.
JJÉ Ñ
ID
JJÑ Ü
}
JJá à
}
JJâ ä
)
JJä ã
;
JJã å
searchServiceKK 
.KK 
SettingsKK "
.KK" #
RootKK# '
=KK( )
contextItemKK* 5
;KK5 6
varLL 
resultsLL 
=LL 
searchServiceLL '
.LL' (
FindAllLL( /
(LL/ 0
)LL0 1
;LL1 2
returnMM 
resultsMM 
.MM 
ResultsMM "
.MM" #
SelectMM# )
(MM) *
xMM* +
=>MM, .
xMM/ 0
.MM0 1
ItemMM1 5
)MM5 6
.MM6 7
WhereMM7 <
(MM< =
xMM= >
=>MM? A
xMMB C
!=MMD F
nullMMG K
&&MML N
xMMO P
.MMP Q
FieldsMMQ W
[MMW X
SitecoreMMX `
.MM` a
FeatureMMa h
.MMh i
LibraryMMi p
.MMp q
	TemplatesMMq z
.MMz {
	BaseField	MM{ Ñ
.
MMÑ Ö
Fields
MMÖ ã
.
MMã å
Date
MMå ê
]
MMê ë
!=
MMí î
null
MMï ô
)
MMô ö
.
MMö õ
OrderByDescending
MMõ ¨
(
MM¨ ≠
i
MM≠ Æ
=>
MMØ ±
i
MM≤ ≥
.
MM≥ ¥
Fields
MM¥ ∫
[
MM∫ ª
Sitecore
MMª √
.
MM√ ƒ
Feature
MMƒ À
.
MMÀ Ã
Library
MMÃ ”
.
MM” ‘
	Templates
MM‘ ›
.
MM› ﬁ
	BaseField
MMﬁ Á
.
MMÁ Ë
Fields
MMË Ó
.
MMÓ Ô
Date
MMÔ Û
]
MMÛ Ù
.
MMÙ ı
Value
MMı ˙
)
MM˙ ˚
;
MM˚ ¸
}NN 	
publicPP 
IEnumerablePP 
<PP 
ItemPP 
>PP  

GetArticlePP! +
(PP+ ,
ItemPP, 0
contextItemPP1 <
)PP< =
{QQ 	
ifRR 
(RR 
contextItemRR 
==RR 
nullRR #
)RR# $
{SS 
throwTT 
newTT !
ArgumentNullExceptionTT /
(TT/ 0
nameofTT0 6
(TT6 7
contextItemTT7 B
)TTB C
)TTC D
;TTD E
}UU 
ifVV 
(VV 
!VV 
contextItemVV 
.VV 
	IsDerivedVV &
(VV& '
	TemplatesVV' 0
.VV0 1
BucketMBMArticleVV1 A
.VVA B
IDVVB D
)VVD E
)VVE F
{WW 
throwXX 
newXX 
ArgumentExceptionXX +
(XX+ ,
$strXX, T
,XXT U
nameofXXV \
(XX\ ]
contextItemXX] h
)XXh i
)XXi j
;XXj k
}YY 
var[[ 
searchService[[ 
=[[ 
this[[  $
.[[$ %#
searchServiceRepository[[% <
.[[< =
Get[[= @
([[@ A
new[[A D
SearchSettingsBase[[E W
{[[X Y
	Templates[[Z c
=[[d e
new[[f i
[[[i j
][[j k
{[[l m
	Templates[[n w
.[[w x
MBMArticlePage	[[x Ü
.
[[Ü á
ID
[[á â
}
[[ä ã
}
[[å ç
)
[[ç é
;
[[é è
searchService\\ 
.\\ 
Settings\\ "
.\\" #
Root\\# '
=\\( )
contextItem\\* 5
;\\5 6
var]] 
results]] 
=]] 
searchService]] '
.]]' (
FindAll]]( /
(]]/ 0
)]]0 1
;]]1 2
return^^ 
results^^ 
.^^ 
Results^^ "
.^^" #
Select^^# )
(^^) *
x^^* +
=>^^, .
x^^/ 0
.^^0 1
Item^^1 5
)^^5 6
.^^6 7
Where^^7 <
(^^< =
x^^= >
=>^^? A
x^^B C
!=^^D F
null^^G K
&&^^L N
x^^O P
.^^P Q
Fields^^Q W
[^^W X
Sitecore^^X `
.^^` a
Feature^^a h
.^^h i
Library^^i p
.^^p q
	Templates^^q z
.^^z {
	BaseField	^^{ Ñ
.
^^Ñ Ö
Fields
^^Ö ã
.
^^ã å
Date
^^å ê
]
^^ê ë
!=
^^í î
null
^^ï ô
)
^^ô ö
.
^^ö õ
OrderByDescending
^^õ ¨
(
^^¨ ≠
i
^^≠ Æ
=>
^^Ø ±
i
^^≤ ≥
.
^^≥ ¥
Fields
^^¥ ∫
[
^^∫ ª
Sitecore
^^ª √
.
^^√ ƒ
Feature
^^ƒ À
.
^^À Ã
Library
^^Ã ”
.
^^” ‘
	Templates
^^‘ ›
.
^^› ﬁ
	BaseField
^^ﬁ Á
.
^^Á Ë
Fields
^^Ë Ó
.
^^Ó Ô
Date
^^Ô Û
]
^^Û Ù
.
^^Ù ı
Value
^^ı ˙
)
^^˙ ˚
;
^^˚ ¸
}__ 	
publicaa 
IEnumerableaa 
<aa 
Itemaa 
>aa  

GetGalleryaa! +
(aa+ ,
Itemaa, 0
contextItemaa1 <
)aa< =
{bb 	
ifcc 
(cc 
contextItemcc 
==cc 
nullcc #
)cc# $
{dd 
throwee 
newee !
ArgumentNullExceptionee /
(ee/ 0
nameofee0 6
(ee6 7
contextItemee7 B
)eeB C
)eeC D
;eeD E
}ff 
ifgg 
(gg 
!gg 
contextItemgg 
.gg 
	IsDerivedgg &
(gg& '
	Templatesgg' 0
.gg0 1
MBMImageBucketgg1 ?
.gg? @
IDgg@ B
)ggB C
)ggC D
{hh 
throwii 
newii 
ArgumentExceptionii +
(ii+ ,
$strii, T
,iiT U
nameofiiV \
(ii\ ]
contextItemii] h
)iih i
)iii j
;iij k
}jj 
varll 
searchServicell 
=ll 
thisll  $
.ll$ %#
searchServiceRepositoryll% <
.ll< =
Getll= @
(ll@ A
newllA D
SearchSettingsBasellE W
{llX Y
	TemplatesllZ c
=lld e
newllf i
[lli j
]llj k
{lll m
	Templateslln w
.llw x
MBMImageItemBucket	llx ä
.
llä ã
ID
llã ç
}
llé è
}
llê ë
)
llë í
;
llí ì
searchServicemm 
.mm 
Settingsmm "
.mm" #
Rootmm# '
=mm( )
contextItemmm* 5
;mm5 6
varnn 
resultsnn 
=nn 
searchServicenn '
.nn' (
FindAllnn( /
(nn/ 0
)nn0 1
;nn1 2
returnoo 
resultsoo 
.oo 
Resultsoo "
.oo" #
Selectoo# )
(oo) *
xoo* +
=>oo, .
xoo/ 0
.oo0 1
Itemoo1 5
)oo5 6
.oo6 7
Whereoo7 <
(oo< =
xoo= >
=>oo? A
xooB C
!=ooD F
nullooG K
&&ooL N
xooO P
.ooP Q
FieldsooQ W
[ooW X
SitecoreooX `
.oo` a
Featureooa h
.ooh i
Libraryooi p
.oop q
	Templatesooq z
.ooz {
	BaseField	oo{ Ñ
.
ooÑ Ö
Fields
ooÖ ã
.
ooã å
Date
ooå ê
]
ooê ë
!=
ooí î
null
ooï ô
)
ooô ö
.
ooö õ
OrderByDescending
ooõ ¨
(
oo¨ ≠
i
oo≠ Æ
=>
ooØ ±
i
oo≤ ≥
.
oo≥ ¥
Fields
oo¥ ∫
[
oo∫ ª
Sitecore
ooª √
.
oo√ ƒ
Feature
ooƒ À
.
ooÀ Ã
Library
ooÃ ”
.
oo” ‘
	Templates
oo‘ ›
.
oo› ﬁ
	BaseField
ooﬁ Á
.
ooÁ Ë
Fields
ooË Ó
.
ooÓ Ô
Date
ooÔ Û
]
ooÛ Ù
.
ooÙ ı
Value
ooı ˙
)
oo˙ ˚
;
oo˚ ¸
}pp 	
publicrr 
IEnumerablerr 
<rr 
Itemrr 
>rr  
GetPromotionrr! -
(rr- .
Itemrr. 2
contextItemrr3 >
)rr> ?
{ss 	
iftt 
(tt 
contextItemtt 
==tt 
nulltt #
)tt# $
{uu 
throwvv 
newvv !
ArgumentNullExceptionvv /
(vv/ 0
nameofvv0 6
(vv6 7
contextItemvv7 B
)vvB C
)vvC D
;vvD E
}ww 
ifxx 
(xx 
!xx 
contextItemxx 
.xx 
	IsDerivedxx &
(xx& '
	Templatesxx' 0
.xx0 1
BucketMBMPromoxx1 ?
.xx? @
IDxx@ B
)xxB C
)xxC D
{yy 
throwzz 
newzz 
ArgumentExceptionzz +
(zz+ ,
$strzz, R
,zzR S
nameofzzT Z
(zzZ [
contextItemzz[ f
)zzf g
)zzg h
;zzh i
}{{ 
var}} 
searchService}} 
=}} 
this}}  $
.}}$ %#
searchServiceRepository}}% <
.}}< =
Get}}= @
(}}@ A
new}}A D
SearchSettingsBase}}E W
{}}X Y
	Templates}}Z c
=}}d e
new}}f i
[}}i j
]}}j k
{}}l m
	Templates}}n w
.}}w x
MBMPromotionPage	}}x à
.
}}à â
ID
}}â ã
}
}}å ç
}
}}é è
)
}}è ê
;
}}ê ë
searchService~~ 
.~~ 
Settings~~ "
.~~" #
Root~~# '
=~~( )
contextItem~~* 5
;~~5 6
var 
results 
= 
searchService '
.' (
FindAll( /
(/ 0
)0 1
;1 2
return
ÄÄ 
results
ÄÄ 
.
ÄÄ 
Results
ÄÄ "
.
ÄÄ" #
Select
ÄÄ# )
(
ÄÄ) *
x
ÄÄ* +
=>
ÄÄ, .
x
ÄÄ/ 0
.
ÄÄ0 1
Item
ÄÄ1 5
)
ÄÄ5 6
.
ÄÄ6 7
Where
ÄÄ7 <
(
ÄÄ< =
x
ÄÄ= >
=>
ÄÄ? A
x
ÄÄB C
!=
ÄÄD F
null
ÄÄG K
&&
ÄÄL N
x
ÄÄO P
.
ÄÄP Q
Fields
ÄÄQ W
[
ÄÄW X
Sitecore
ÄÄX `
.
ÄÄ` a
Feature
ÄÄa h
.
ÄÄh i
Library
ÄÄi p
.
ÄÄp q
	Templates
ÄÄq z
.
ÄÄz {
	BaseFieldÄÄ{ Ñ
.ÄÄÑ Ö
FieldsÄÄÖ ã
.ÄÄã å
DateÄÄå ê
]ÄÄê ë
!=ÄÄí î
nullÄÄï ô
)ÄÄô ö
.ÄÄö õ!
OrderByDescendingÄÄõ ¨
(ÄÄ¨ ≠
iÄÄ≠ Æ
=>ÄÄØ ±
iÄÄ≤ ≥
.ÄÄ≥ ¥
FieldsÄÄ¥ ∫
[ÄÄ∫ ª
SitecoreÄÄª √
.ÄÄ√ ƒ
FeatureÄÄƒ À
.ÄÄÀ Ã
LibraryÄÄÃ ”
.ÄÄ” ‘
	TemplatesÄÄ‘ ›
.ÄÄ› ﬁ
	BaseFieldÄÄﬁ Á
.ÄÄÁ Ë
FieldsÄÄË Ó
.ÄÄÓ Ô
DateÄÄÔ Û
]ÄÄÛ Ù
.ÄÄÙ ı
ValueÄÄı ˙
)ÄÄ˙ ˚
;ÄÄ˚ ¸
}
ÅÅ 	
public
ÉÉ 
IEnumerable
ÉÉ 
<
ÉÉ 
Item
ÉÉ 
>
ÉÉ  
GetFoodSite
ÉÉ! ,
(
ÉÉ, -
Item
ÉÉ- 1
contextItem
ÉÉ2 =
)
ÉÉ= >
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
contextItem
ÖÖ 
==
ÖÖ 
null
ÖÖ #
)
ÖÖ# $
{
ÜÜ 
throw
áá 
new
áá #
ArgumentNullException
áá /
(
áá/ 0
nameof
áá0 6
(
áá6 7
contextItem
áá7 B
)
ááB C
)
ááC D
;
ááD E
}
àà 
if
ââ 
(
ââ 
!
ââ 
contextItem
ââ 
.
ââ 
	IsDerived
ââ &
(
ââ& '
	Templates
ââ' 0
.
ââ0 1
BucketFoodSite
ââ1 ?
.
ââ? @
ID
ââ@ B
)
ââB C
)
ââC D
{
ää 
throw
ãã 
new
ãã 
ArgumentException
ãã +
(
ãã+ ,
$str
ãã, R
,
ããR S
nameof
ããT Z
(
ããZ [
contextItem
ãã[ f
)
ããf g
)
ããg h
;
ããh i
}
åå 
var
éé 
searchService
éé 
=
éé 
this
éé  $
.
éé$ %%
searchServiceRepository
éé% <
.
éé< =
Get
éé= @
(
éé@ A
new
ééA D 
SearchSettingsBase
ééE W
{
ééX Y
	Templates
ééZ c
=
ééd e
new
ééf i
[
ééi j
]
ééj k
{
éél m
	Templates
één w
.
ééw x
MBMFoodSiteItemééx á
.ééá à
IDééà ä
}ééã å
}ééç é
)ééé è
;ééè ê
searchService
èè 
.
èè 
Settings
èè "
.
èè" #
Root
èè# '
=
èè( )
contextItem
èè* 5
;
èè5 6
var
êê 
results
êê 
=
êê 
searchService
êê '
.
êê' (
FindAll
êê( /
(
êê/ 0
)
êê0 1
;
êê1 2
return
ëë 
results
ëë 
.
ëë 
Results
ëë "
.
ëë" #
Select
ëë# )
(
ëë) *
x
ëë* +
=>
ëë, .
x
ëë/ 0
.
ëë0 1
Item
ëë1 5
)
ëë5 6
.
ëë6 7
Where
ëë7 <
(
ëë< =
x
ëë= >
=>
ëë? A
x
ëëB C
!=
ëëD F
null
ëëG K
&&
ëëL N
x
ëëO P
.
ëëP Q
Fields
ëëQ W
[
ëëW X
Sitecore
ëëX `
.
ëë` a
Feature
ëëa h
.
ëëh i
Library
ëëi p
.
ëëp q
	Templates
ëëq z
.
ëëz {
	BaseFieldëë{ Ñ
.ëëÑ Ö
FieldsëëÖ ã
.ëëã å
Dateëëå ê
]ëëê ë
!=ëëí î
nullëëï ô
)ëëô ö
.ëëö õ!
OrderByDescendingëëõ ¨
(ëë¨ ≠
iëë≠ Æ
=>ëëØ ±
iëë≤ ≥
.ëë≥ ¥
Fieldsëë¥ ∫
[ëë∫ ª
Sitecoreëëª √
.ëë√ ƒ
Featureëëƒ À
.ëëÀ Ã
LibraryëëÃ ”
.ëë” ‘
	Templatesëë‘ ›
.ëë› ﬁ
	BaseFieldëëﬁ Á
.ëëÁ Ë
FieldsëëË Ó
.ëëÓ Ô
DateëëÔ Û
]ëëÛ Ù
.ëëÙ ı
Valueëëı ˙
)ëë˙ ˚
;ëë˚ ¸
}
íí 	
public
ïï 
IEnumerable
ïï 
<
ïï 
Item
ïï 
>
ïï  
GetMaybankBlog
ïï! /
(
ïï/ 0
Item
ïï0 4
contextItem
ïï5 @
)
ïï@ A
{
ññ 	
if
óó 
(
óó 
contextItem
óó 
==
óó 
null
óó #
)
óó# $
{
òò 
throw
ôô 
new
ôô #
ArgumentNullException
ôô /
(
ôô/ 0
nameof
ôô0 6
(
ôô6 7
contextItem
ôô7 B
)
ôôB C
)
ôôC D
;
ôôD E
}
öö 
if
õõ 
(
õõ 
!
õõ 
contextItem
õõ 
.
õõ 
	IsDerived
õõ &
(
õõ& '
	Templates
õõ' 0
.
õõ0 1
BucketMaybankBlog
õõ1 B
.
õõB C
ID
õõC E
)
õõE F
)
õõF G
{
úú 
throw
ùù 
new
ùù 
ArgumentException
ùù +
(
ùù+ ,
$str
ùù, W
,
ùùW X
nameof
ùùY _
(
ùù_ `
contextItem
ùù` k
)
ùùk l
)
ùùl m
;
ùùm n
}
ûû 
var
†† 
searchService
†† 
=
†† 
this
††  $
.
††$ %%
searchServiceRepository
††% <
.
††< =
Get
††= @
(
††@ A
new
††A D 
SearchSettingsBase
††E W
{
††X Y
	Templates
††Z c
=
††d e
new
††f i
[
††i j
]
††j k
{
††l m
	Templates
††n w
.
††w x
ItemMaybankBlog††x á
.††á à
ID††à ä
}††ã å
}††ç é
)††é è
;††è ê
searchService
°° 
.
°° 
Settings
°° "
.
°°" #
Root
°°# '
=
°°( )
contextItem
°°* 5
;
°°5 6
var
¢¢ 
results
¢¢ 
=
¢¢ 
searchService
¢¢ '
.
¢¢' (
FindAll
¢¢( /
(
¢¢/ 0
)
¢¢0 1
;
¢¢1 2
return
££ 
results
££ 
.
££ 
Results
££ "
.
££" #
Select
££# )
(
££) *
x
££* +
=>
££, .
x
££/ 0
.
££0 1
Item
££1 5
)
££5 6
.
££6 7
Where
££7 <
(
££< =
x
££= >
=>
££? A
x
££B C
!=
££D F
null
££G K
&&
££L N
x
££O P
.
££P Q
Fields
££Q W
[
££W X
Sitecore
££X `
.
££` a
Feature
££a h
.
££h i
Library
££i p
.
££p q
	Templates
££q z
.
££z {
NewsArticle££{ Ü
.££Ü á
Fields££á ç
.££ç é
Date££é í
]££í ì
!=££î ñ
null££ó õ
)££õ ú
.££ú ù!
OrderByDescending££ù Æ
(££Æ Ø
i££Ø ∞
=>££± ≥
i££¥ µ
.££µ ∂
Fields££∂ º
[££º Ω
Sitecore££Ω ≈
.££≈ ∆
Feature££∆ Õ
.££Õ Œ
Library££Œ ’
.££’ ÷
	Templates££÷ ﬂ
.££ﬂ ‡
NewsArticle££‡ Î
.££Î Ï
Fields££Ï Ú
.££Ú Û
Date££Û ˜
]££˜ ¯
.££¯ ˘
Value££˘ ˛
)££˛ ˇ
;££ˇ Ä
}
§§ 	
public
•• 
IEnumerable
•• 
<
•• 
Item
•• 
>
••  
GetAllMaybankBlog
••! 2
(
••2 3
IEnumerable
••3 >
<
••> ?
Data
••? C
.
••C D
Items
••D I
.
••I J
Item
••J N
>
••N O
items
••P U
)
••U V
{
¶¶ 	
if
ßß 
(
ßß 
items
ßß 
!=
ßß 
null
ßß 
)
ßß 
{
®® 
items
©© 
=
©© 
items
©© 
.
©© 
OrderByDescending
©© /
(
©©/ 0
x
©©0 1
=>
©©2 4
x
©©5 6
.
©©6 7
Fields
©©7 =
[
©©= >
Sitecore
©©> F
.
©©F G
Feature
©©G N
.
©©N O
Library
©©O V
.
©©V W
	Templates
©©W `
.
©©` a
NewsArticle
©©a l
.
©©l m
Fields
©©m s
.
©©s t
Date
©©t x
]
©©x y
.
©©y z
Value
©©z 
)©© Ä
.
™™ 
ThenByDescending
™™ %
(
™™% &
x
™™& '
=>
™™( *
x
™™+ ,
.
™™, -
Created
™™- 4
)
™™4 5
;
™™5 6
}
´´ 
return
¨¨ 
items
¨¨ 
;
¨¨ 
}
≠≠ 	
public
ÆÆ 
IEnumerable
ÆÆ 
<
ÆÆ 
Item
ÆÆ 
>
ÆÆ  &
GetMaybankBlogByCategory
ÆÆ! 9
(
ÆÆ9 :
IEnumerable
ÆÆ: E
<
ÆÆE F
Data
ÆÆF J
.
ÆÆJ K
Items
ÆÆK P
.
ÆÆP Q
Item
ÆÆQ U
>
ÆÆU V
items
ÆÆW \
,
ÆÆ\ ]
string
ÆÆ^ d
	_category
ÆÆe n
)
ÆÆn o
{
ØØ 	
if
∞∞ 
(
∞∞ 
items
∞∞ 
!=
∞∞ 
null
∞∞ 
&&
∞∞  
	_category
∞∞! *
!=
∞∞+ -
string
∞∞. 4
.
∞∞4 5
Empty
∞∞5 :
)
∞∞: ;
{
±± 
items
≤≤ 
=
≤≤ 
items
≤≤ 
.
≤≤ 
Where
≤≤ #
(
≤≤# $
x
≤≤$ %
=>
≤≤& (
x
≤≤) *
.
≤≤* +
Fields
≤≤+ 1
[
≤≤1 2
Sitecore
≤≤2 :
.
≤≤: ;
Feature
≤≤; B
.
≤≤B C
Library
≤≤C J
.
≤≤J K
	Templates
≤≤K T
.
≤≤T U
ItemMaybankBlog
≤≤U d
.
≤≤d e
Fields
≤≤e k
.
≤≤k l
Category
≤≤l t
]
≤≤t u
.
≤≤u v
Value
≤≤v {
.
≤≤{ |
Replace≤≤| É
(≤≤É Ñ
$str≤≤Ñ á
,≤≤á à
$str≤≤â ã
)≤≤ã å
.≤≤å ç
ToLower≤≤ç î
(≤≤î ï
)≤≤ï ñ
.≤≤ñ ó
Contains≤≤ó ü
(≤≤ü †
	_category≤≤† ©
.≤≤© ™
Replace≤≤™ ±
(≤≤± ≤
$str≤≤≤ µ
,≤≤µ ∂
$str≤≤∑ π
)≤≤π ∫
.≤≤∫ ª
ToLower≤≤ª ¬
(≤≤¬ √
)≤≤√ ƒ
)≤≤ƒ ≈
)≤≤≈ ∆
;≤≤∆ «
items
≥≥ 
=
≥≥ 
items
≥≥ 
.
≥≥ 
OrderByDescending
≥≥ /
(
≥≥/ 0
x
≥≥0 1
=>
≥≥2 4
x
≥≥5 6
.
≥≥6 7
Fields
≥≥7 =
[
≥≥= >
Sitecore
≥≥> F
.
≥≥F G
Feature
≥≥G N
.
≥≥N O
Library
≥≥O V
.
≥≥V W
	Templates
≥≥W `
.
≥≥` a
NewsArticle
≥≥a l
.
≥≥l m
Fields
≥≥m s
.
≥≥s t
Date
≥≥t x
]
≥≥x y
.
≥≥y z
Value
≥≥z 
)≥≥ Ä
.
¥¥ 
ThenByDescending
¥¥ %
(
¥¥% &
x
¥¥& '
=>
¥¥( *
x
¥¥+ ,
.
¥¥, -
Created
¥¥- 4
)
¥¥4 5
;
¥¥5 6
}
µµ 
return
∂∂ 
items
∂∂ 
;
∂∂ 
}
∑∑ 	
public
∏∏ 
string
∏∏ $
GetMaybankBlogCategory
∏∏ ,
(
∏∏, -
Item
∏∏- 1
item
∏∏2 6
)
∏∏6 7
{
ππ 	
MultilistField
∫∫ 
	ListValue
∫∫ $
=
∫∫% &
null
∫∫' +
;
∫∫+ ,
string
ªª 
CategoryValue
ªª  
=
ªª! "
string
ªª# )
.
ªª) *
Empty
ªª* /
;
ªª/ 0
Item
ºº 
_items
ºº 
=
ºº 
Sitecore
ºº "
.
ºº" #
Context
ºº# *
.
ºº* +
Database
ºº+ 3
.
ºº3 4
GetItem
ºº4 ;
(
ºº; <
item
ºº< @
.
ºº@ A
ID
ººA C
)
ººC D
;
ººD E
	ListValue
ææ 
=
ææ 
_items
ææ 
.
ææ 
Fields
ææ %
[
ææ% &
Sitecore
ææ& .
.
ææ. /
Feature
ææ/ 6
.
ææ6 7
Library
ææ7 >
.
ææ> ?
	Templates
ææ? H
.
ææH I
ItemMaybankBlog
ææI X
.
ææX Y
Fields
ææY _
.
ææ_ `
Category
ææ` h
]
ææh i
;
ææi j
if
øø 
(
øø 
	ListValue
øø 
!=
øø 
null
øø !
)
øø! "
{
¿¿ 
Item
¡¡ 
[
¡¡ 
]
¡¡ 
items
¡¡ 
=
¡¡ 
	ListValue
¡¡ (
.
¡¡( )
GetItems
¡¡) 1
(
¡¡1 2
)
¡¡2 3
;
¡¡3 4
CategoryValue
¬¬ 
=
¬¬ 
items
¬¬  %
.
¬¬% &
Select
¬¬& ,
(
¬¬, -
x
¬¬- .
=>
¬¬/ 1
x
¬¬2 3
.
¬¬3 4
Fields
¬¬4 :
[
¬¬: ;
Sitecore
¬¬; C
.
¬¬C D
Feature
¬¬D K
.
¬¬K L
Library
¬¬L S
.
¬¬S T
	Templates
¬¬T ]
.
¬¬] ^
	BaseField
¬¬^ g
.
¬¬g h
Fields
¬¬h n
.
¬¬n o
IconName
¬¬o w
]
¬¬w x
.
¬¬x y
Value
¬¬y ~
)
¬¬~ 
.¬¬ Ä
FirstOrDefault¬¬Ä é
(¬¬é è
)¬¬è ê
;¬¬ê ë
}
√√ 
return
ƒƒ 
CategoryValue
ƒƒ  
;
ƒƒ  !
}
≈≈ 	
public
∆∆ 
List
∆∆ 
<
∆∆ 
BlogComment
∆∆ 
>
∆∆  
GetAllComment
∆∆! .
(
∆∆. /
)
∆∆/ 0
{
«« 	
using
»» 
(
»» 
var
»» 
db
»» 
=
»» 
Factory
»» #
.
»»# $

DbEntities
»»$ .
)
»». /
{
…… 
var
   
items
   
=
   
db
   
.
   
BlogComment
   *
;
  * +
return
ÀÀ 
items
ÀÀ 
.
ÀÀ 
ToList
ÀÀ #
(
ÀÀ# $
)
ÀÀ$ %
;
ÀÀ% &
}
ÃÃ 
}
ÕÕ 	
public
ŒŒ 
IEnumerable
ŒŒ 
<
ŒŒ 
BlogComment
ŒŒ &
>
ŒŒ& '#
GetAllCommentByBlogId
ŒŒ( =
(
ŒŒ= >
string
ŒŒ> D
blogId
ŒŒE K
)
ŒŒK L
{
œœ 	
IEnumerable
–– 
<
–– 
BlogComment
–– #
>
––# $
listcomment
––% 0
=
––1 2
GetAllComment
––3 @
(
––@ A
)
––A B
.
––B C
Where
––C H
(
––H I
x
––I J
=>
––K M
(
––N O
x
––O P
.
––P Q
PageID
––Q W
!=
––X Z
null
––[ _
?
––` a
x
––b c
.
––c d
PageID
––d j
:
––k l
string
––m s
.
––s t
Empty
––t y
)
––y z
!=
––{ }
string––~ Ñ
.––Ñ Ö
Empty––Ö ä
)––ä ã
;––ã å
listcomment
—— 
=
—— 
listcomment
—— %
.
——% &
Where
——& +
(
——+ ,
x
——, -
=>
——. 0
x
——1 2
.
——2 3
PageID
——3 9
.
——9 :
ToLower
——: A
(
——A B
)
——B C
.
——C D
Contains
——D L
(
——L M
blogId
——M S
.
——S T
ToLower
——T [
(
——[ \
)
——\ ]
.
——] ^
Trim
——^ b
(
——b c
)
——c d
)
——d e
)
——e f
;
——f g
listcomment
““ 
=
““ 
listcomment
““ %
.
““% &
Where
““& +
(
““+ ,
x
““, -
=>
““. 0
x
““1 2
.
““2 3

isApproved
““3 =
&&
““> @
x
““A B
.
““B C
ApprovedDate
““C O
!=
““P R
null
““S W
&&
““X Z
!
““[ \
x
““\ ]
.
““] ^
isDelete
““^ f
)
““f g
;
““g h
return
”” 
listcomment
”” 
;
”” 
}
‘‘ 	
public
’’ 
void
’’ 
PostComment
’’ 
(
’’  
BlogComment
’’  +
BlogComment
’’, 7
)
’’7 8
{
÷÷ 	
using
◊◊ 
(
◊◊ 
var
◊◊ 
db
◊◊ 
=
◊◊ 
Factory
◊◊ #
.
◊◊# $

DbEntities
◊◊$ .
)
◊◊. /
{
ÿÿ 
try
ŸŸ 
{
⁄⁄ 
if
€€ 
(
€€ 
!
€€ 
string
€€ 
.
€€  
IsNullOrEmpty
€€  -
(
€€- .
BlogComment
€€. 9
.
€€9 :
PageID
€€: @
)
€€@ A
)
€€A B
{
‹‹ 
db
›› 
.
›› 
BlogComment
›› &
.
››& '
Add
››' *
(
››* +
BlogComment
››+ 6
)
››6 7
;
››7 8
db
ﬁﬁ 
.
ﬁﬁ 
SaveChanges
ﬁﬁ &
(
ﬁﬁ& '
)
ﬁﬁ' (
;
ﬁﬁ( )
}
ﬂﬂ 
}
‡‡ 
catch
·· 
(
·· 
	Exception
··  
ex
··! #
)
··# $
{
‚‚ 
StringBuilder
„„ !
sb
„„" $
=
„„% &
new
„„' *
StringBuilder
„„+ 8
(
„„8 9
)
„„9 :
;
„„: ;
sb
‰‰ 
.
‰‰ 

AppendLine
‰‰ !
(
‰‰! "
ex
‰‰" $
.
‰‰$ %
Message
‰‰% ,
)
‰‰, -
;
‰‰- .
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 	
public
ËË 
Tuple
ËË 
<
ËË 
int
ËË 
,
ËË 
IEnumerable
ËË %
<
ËË% &
BlogCommentDto
ËË& 4
>
ËË4 5
>
ËË5 6$
LoadAllCommentByBlogId
ËË7 M
(
ËËM N
string
ËËN T
blogId
ËËU [
,
ËË[ \
int
ËË] `
index
ËËa f
)
ËËf g
{
ÈÈ 	
int
ÍÍ 
CountTotalItem
ÍÍ 
=
ÍÍ  #
GetAllCommentByBlogId
ÍÍ! 6
(
ÍÍ6 7
blogId
ÍÍ7 =
)
ÍÍ= >
.
ÍÍ> ?
Count
ÍÍ? D
(
ÍÍD E
)
ÍÍE F
;
ÍÍF G
IEnumerable
ÎÎ 
<
ÎÎ 
BlogCommentDto
ÎÎ &
>
ÎÎ& ' 
AllCommentByBlogId
ÎÎ( :
=
ÎÎ; <#
GetAllCommentByBlogId
ÎÎ= R
(
ÎÎR S
blogId
ÎÎS Y
)
ÎÎY Z
.
ÏÏ< =
Select
ÏÏ= C
(
ÏÏC D
x
ÏÏD E
=>
ÏÏF H
new
ÏÏI L
BlogCommentDto
ÏÏM [
(
ÏÏ[ \
)
ÏÏ\ ]
{
ÌÌ< =
Username
ÓÓ@ H
=
ÓÓI J
x
ÓÓK L
.
ÓÓL M
Username
ÓÓM U
,
ÓÓU V
Comment
ÔÔ@ G
=
ÔÔH I
x
ÔÔJ K
.
ÔÔK L
Comment
ÔÔL S
,
ÔÔS T
CommentDate
@ K
=
L M
x
N O
.
O P
CommentDate
P [
}
ÒÒ< =
)
ÒÒ= >
;
ÒÒ> ? 
AllCommentByBlogId
ÚÚ 
=
ÚÚ   
AllCommentByBlogId
ÚÚ! 3
.
ÚÚ3 4
OrderByDescending
ÚÚ4 E
(
ÚÚE F
x
ÚÚF G
=>
ÚÚH J
x
ÚÚK L
.
ÚÚL M
CommentDate
ÚÚM X
)
ÚÚX Y
.
ÚÚY Z
Take
ÚÚZ ^
(
ÚÚ^ _
index
ÚÚ_ d
)
ÚÚd e
;
ÚÚe f
return
ÛÛ 
Tuple
ÛÛ 
.
ÛÛ 
Create
ÛÛ 
(
ÛÛ  
CountTotalItem
ÛÛ  .
,
ÛÛ. / 
AllCommentByBlogId
ÛÛ0 B
)
ÛÛB C
;
ÛÛC D
}
ÙÙ 	
public
ıı 
Tuple
ıı 
<
ıı 
int
ıı 
,
ıı 
List
ıı 
<
ıı 
BlogComment
ıı *
>
ıı* +
>
ıı+ ,&
GetAllNotApprovedComment
ıı- E
(
ııE F
)
ııF G
{
ˆˆ 	
IEnumerable
˜˜ 
<
˜˜ 
BlogComment
˜˜ #
>
˜˜# $
item
˜˜% )
=
˜˜* +
GetAllComment
˜˜, 9
(
˜˜9 :
)
˜˜: ;
.
˜˜; <
Where
˜˜< A
(
˜˜A B
x
˜˜B C
=>
˜˜D F
!
˜˜G H
x
˜˜H I
.
˜˜I J

isApproved
˜˜J T
&&
˜˜U W
!
˜˜X Y
x
˜˜Y Z
.
˜˜Z [
isDelete
˜˜[ c
)
˜˜c d
;
˜˜d e
return
¯¯ 
Tuple
¯¯ 
.
¯¯ 
Create
¯¯ 
(
¯¯  
item
¯¯  $
.
¯¯$ %
Count
¯¯% *
(
¯¯* +
)
¯¯+ ,
,
¯¯, -
item
¯¯. 2
.
¯¯2 3
ToList
¯¯3 9
(
¯¯9 :
)
¯¯: ;
)
¯¯; <
;
¯¯< =
}
˘˘ 	
}
˚˚ 
}¸¸ Ö
HC:\Review Code\Maybank Blog\Content\code\Repositories\IBlogRepository.cs
	namespace 	
Sitecore
 
. 
Feature 
. 
Content "
." #
Repositories# /
{ 
public

 

	interface

 
IBlogRepository

 $
{ 
IEnumerable 
< 
Item 
> 
Get 
( 
Item "
contextItem# .
). /
;/ 0
IEnumerable 
< 
Item 
> 

GetArticle $
($ %
Item% )
contextItem* 5
)5 6
;6 7
IEnumerable 
< 
Item 
> 

GetGallery $
($ %
Item% )
contextItem* 5
)5 6
;6 7
IEnumerable 
< 
Item 
> 
GetPromotion &
(& '
Item' +
contextItem, 7
)7 8
;8 9
IEnumerable 
< 
Item 
> 
GetFoodSite %
(% &
Item& *
contextItem+ 6
)6 7
;7 8
IEnumerable 
< 
Item 
> 
GetMaybankBlog (
(( )
Item) -
contextItem. 9
)9 :
;: ;
IEnumerable 
< 
Item 
> 
GetAllMaybankBlog +
(+ ,
IEnumerable, 7
<7 8
Data8 <
.< =
Items= B
.B C
ItemC G
>G H
itemsI N
)N O
;O P
IEnumerable 
< 
Item 
> $
GetMaybankBlogByCategory 2
(2 3
IEnumerable3 >
<> ?
Data? C
.C D
ItemsD I
.I J
ItemJ N
>N O
itemsP U
,U V
stringW ]
	_category^ g
)g h
;h i
void 
PostComment 
( 
BlogComment $
BlogComment% 0
)0 1
;1 2
IEnumerable 
< 
BlogComment 
>  !
GetAllCommentByBlogId! 6
(6 7
string7 =
blogId> D
)D E
;E F
List 
< 
BlogComment 
> 
GetAllComment '
(' (
)( )
;) *
Tuple 
< 
int 
, 
IEnumerable 
< 
BlogCommentDto -
>- .
>. /"
LoadAllCommentByBlogId0 F
(F G
stringG M
blogIdN T
,T U
intV Y
indexZ _
)_ `
;` a
Tuple 
< 
int 
, 
List 
< 
BlogComment #
># $
>$ %$
GetAllNotApprovedComment& >
(> ?
)? @
;@ A
} 
} 